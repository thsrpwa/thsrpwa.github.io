import{c as Ge,d as Re,e as Je,i as Ze}from"./chunk-F4AZ2R32.js";import{a as Fe,c as se,e as ue,f as le,g as Ve,i as je,j as Ae,m as Ye,p as He,q as Pe,r as Ue,s as Be,v as Le,w as ce,x as We}from"./chunk-TZ5BZHLV.js";import{$ as Me,Ab as oe,Ba as J,Ca as Z,Da as z,Ea as h,Fa as g,Ga as A,H as _e,Ha as we,Ja as re,Ka as q,Kb as ae,M as W,S as te,T as ne,Ua as Ne,Va as T,Wa as ie,Xa as Ee,_ as E,aa as O,c as it,d as Se,da as m,eb as Oe,fb as Ie,gb as xe,ja as Te,ka as P,pa as G,ua as b,ub as I,vb as ke,za as R}from"./chunk-O2LKXLAO.js";var ve=it((he,ge)=>{"use strict";(function(c,e){typeof he=="object"&&typeof ge<"u"?ge.exports=e():typeof define=="function"&&define.amd?define(e):(c=typeof globalThis<"u"?globalThis:c||self).dayjs=e()})(he,function(){"use strict";var c=1e3,e=6e4,n=36e5,o="millisecond",D="second",C="minute",f="hour",M="day",Q="week",N="month",ye="quarter",x="year",Y="date",$e="Invalid Date",et=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,tt=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,nt={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(s){var i=["th","st","nd","rd"],t=s%100;return"["+s+(i[(t-20)%10]||i[t]||i[0])+"]"}},me=function(s,i,t){var a=String(s);return!a||a.length>=i?s:""+Array(i+1-a.length).join(t)+s},rt={s:me,z:function(s){var i=-s.utcOffset(),t=Math.abs(i),a=Math.floor(t/60),r=t%60;return(i<=0?"+":"-")+me(a,2,"0")+":"+me(r,2,"0")},m:function s(i,t){if(i.date()<t.date())return-s(t,i);var a=12*(t.year()-i.year())+(t.month()-i.month()),r=i.clone().add(a,N),u=t-r<0,l=i.clone().add(a+(u?-1:1),N);return+(-(a+(t-r)/(u?r-l:l-r))||0)},a:function(s){return s<0?Math.ceil(s)||0:Math.floor(s)},p:function(s){return{M:N,y:x,w:Q,d:M,D:Y,h:f,m:C,s:D,ms:o,Q:ye}[s]||String(s||"").toLowerCase().replace(/s$/,"")},u:function(s){return s===void 0}},U="en",F={};F[U]=nt;var be="$isDayjsObject",fe=function(s){return s instanceof X||!(!s||!s[be])},K=function s(i,t,a){var r;if(!i)return U;if(typeof i=="string"){var u=i.toLowerCase();F[u]&&(r=u),t&&(F[u]=t,r=u);var l=i.split("-");if(!r&&l.length>1)return s(l[0])}else{var d=i.name;F[d]=i,r=d}return!a&&r&&(U=r),r||!a&&U},y=function(s,i){if(fe(s))return s.clone();var t=typeof i=="object"?i:{};return t.date=s,t.args=arguments,new X(t)},p=rt;p.l=K,p.i=fe,p.w=function(s,i){return y(s,{locale:i.$L,utc:i.$u,x:i.$x,$offset:i.$offset})};var X=function(){function s(t){this.$L=K(t.locale,null,!0),this.parse(t),this.$x=this.$x||t.x||{},this[be]=!0}var i=s.prototype;return i.parse=function(t){this.$d=function(a){var r=a.date,u=a.utc;if(r===null)return new Date(NaN);if(p.u(r))return new Date;if(r instanceof Date)return new Date(r);if(typeof r=="string"&&!/Z$/i.test(r)){var l=r.match(et);if(l){var d=l[2]-1||0,v=(l[7]||"0").substring(0,3);return u?new Date(Date.UTC(l[1],d,l[3]||1,l[4]||0,l[5]||0,l[6]||0,v)):new Date(l[1],d,l[3]||1,l[4]||0,l[5]||0,l[6]||0,v)}}return new Date(r)}(t),this.init()},i.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},i.$utils=function(){return p},i.isValid=function(){return this.$d.toString()!==$e},i.isSame=function(t,a){var r=y(t);return this.startOf(a)<=r&&r<=this.endOf(a)},i.isAfter=function(t,a){return y(t)<this.startOf(a)},i.isBefore=function(t,a){return this.endOf(a)<y(t)},i.$g=function(t,a,r){return p.u(t)?this[a]:this.set(r,t)},i.unix=function(){return Math.floor(this.valueOf()/1e3)},i.valueOf=function(){return this.$d.getTime()},i.startOf=function(t,a){var r=this,u=!!p.u(a)||a,l=p.p(t),d=function(j,_){var k=p.w(r.$u?Date.UTC(r.$y,_,j):new Date(r.$y,_,j),r);return u?k:k.endOf(M)},v=function(j,_){return p.w(r.toDate()[j].apply(r.toDate("s"),(u?[0,0,0,0]:[23,59,59,999]).slice(_)),r)},$=this.$W,S=this.$M,w=this.$D,H="set"+(this.$u?"UTC":"");switch(l){case x:return u?d(1,0):d(31,11);case N:return u?d(1,S):d(0,S+1);case Q:var V=this.$locale().weekStart||0,B=($<V?$+7:$)-V;return d(u?w-B:w+(6-B),S);case M:case Y:return v(H+"Hours",0);case f:return v(H+"Minutes",1);case C:return v(H+"Seconds",2);case D:return v(H+"Milliseconds",3);default:return this.clone()}},i.endOf=function(t){return this.startOf(t,!1)},i.$set=function(t,a){var r,u=p.p(t),l="set"+(this.$u?"UTC":""),d=(r={},r[M]=l+"Date",r[Y]=l+"Date",r[N]=l+"Month",r[x]=l+"FullYear",r[f]=l+"Hours",r[C]=l+"Minutes",r[D]=l+"Seconds",r[o]=l+"Milliseconds",r)[u],v=u===M?this.$D+(a-this.$W):a;if(u===N||u===x){var $=this.clone().set(Y,1);$.$d[d](v),$.init(),this.$d=$.set(Y,Math.min(this.$D,$.daysInMonth())).$d}else d&&this.$d[d](v);return this.init(),this},i.set=function(t,a){return this.clone().$set(t,a)},i.get=function(t){return this[p.p(t)]()},i.add=function(t,a){var r,u=this;t=Number(t);var l=p.p(a),d=function(S){var w=y(u);return p.w(w.date(w.date()+Math.round(S*t)),u)};if(l===N)return this.set(N,this.$M+t);if(l===x)return this.set(x,this.$y+t);if(l===M)return d(1);if(l===Q)return d(7);var v=(r={},r[C]=e,r[f]=n,r[D]=c,r)[l]||1,$=this.$d.getTime()+t*v;return p.w($,this)},i.subtract=function(t,a){return this.add(-1*t,a)},i.format=function(t){var a=this,r=this.$locale();if(!this.isValid())return r.invalidDate||$e;var u=t||"YYYY-MM-DDTHH:mm:ssZ",l=p.z(this),d=this.$H,v=this.$m,$=this.$M,S=r.weekdays,w=r.months,H=r.meridiem,V=function(_,k,L,ee){return _&&(_[k]||_(a,u))||L[k].slice(0,ee)},B=function(_){return p.s(d%12||12,_,"0")},j=H||function(_,k,L){var ee=_<12?"AM":"PM";return L?ee.toLowerCase():ee};return u.replace(tt,function(_,k){return k||function(L){switch(L){case"YY":return String(a.$y).slice(-2);case"YYYY":return p.s(a.$y,4,"0");case"M":return $+1;case"MM":return p.s($+1,2,"0");case"MMM":return V(r.monthsShort,$,w,3);case"MMMM":return V(w,$);case"D":return a.$D;case"DD":return p.s(a.$D,2,"0");case"d":return String(a.$W);case"dd":return V(r.weekdaysMin,a.$W,S,2);case"ddd":return V(r.weekdaysShort,a.$W,S,3);case"dddd":return S[a.$W];case"H":return String(d);case"HH":return p.s(d,2,"0");case"h":return B(1);case"hh":return B(2);case"a":return j(d,v,!0);case"A":return j(d,v,!1);case"m":return String(v);case"mm":return p.s(v,2,"0");case"s":return String(a.$s);case"ss":return p.s(a.$s,2,"0");case"SSS":return p.s(a.$ms,3,"0");case"Z":return l}return null}(_)||l.replace(":","")})},i.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},i.diff=function(t,a,r){var u,l=this,d=p.p(a),v=y(t),$=(v.utcOffset()-this.utcOffset())*e,S=this-v,w=function(){return p.m(l,v)};switch(d){case x:u=w()/12;break;case N:u=w();break;case ye:u=w()/3;break;case Q:u=(S-$)/6048e5;break;case M:u=(S-$)/864e5;break;case f:u=S/n;break;case C:u=S/e;break;case D:u=S/c;break;default:u=S}return r?u:p.a(u)},i.daysInMonth=function(){return this.endOf(N).$D},i.$locale=function(){return F[this.$L]},i.locale=function(t,a){if(!t)return this.$L;var r=this.clone(),u=K(t,a,!0);return u&&(r.$L=u),r},i.clone=function(){return p.w(this.$d,this)},i.toDate=function(){return new Date(this.valueOf())},i.toJSON=function(){return this.isValid()?this.toISOString():null},i.toISOString=function(){return this.$d.toISOString()},i.toString=function(){return this.$d.toUTCString()},s}(),De=X.prototype;return y.prototype=De,[["$ms",o],["$s",D],["$m",C],["$H",f],["$W",M],["$M",N],["$y",x],["$D",Y]].forEach(function(s){De[s[1]]=function(i){return this.$g(i,s[0],s[1])}}),y.extend=function(s,i){return s.$i||(s(i,X,y),s.$i=!0),y},y.locale=K,y.isDayjs=fe,y.unix=function(s){return y(1e3*s)},y.en=F[U],y.Ls=F,y.p={},y})});var ot=(n=>(n[n.general=1]="general",n[n.group=2]="group",n))(ot||{});var at=(o=>(o[o.booking=1]="booking",o[o.change=2]="change",o[o.changeSeat=3]="changeSeat",o))(at||{});var ze=class{trip=O(null);promotions=O([]);roundTrip=I(()=>this.trip()?.tripType===2);promotionCode=I(()=>this.trip()?.passengers.find(e=>e.tickets.find(n=>n.promotionCode))?.tickets[0].promotionCode);selectedPromotion=I(()=>this.promotions()?.find(e=>e.promotionCode===this.promotionCode())||null);seatTaken=I(()=>this.trip()?.passengers.every(e=>e.tickets.every(n=>n.car&&n.seatRow&&n.seatCol)));inbound=I(()=>this.trip()?.trains.find(e=>e.journey==="INBOUND"));outbound=I(()=>this.trip()?.trains.find(e=>e.journey==="OUTBOUND"));promotionTickets=I(()=>{let e=this.trip();if(!e||!this.promotionCode())return null;let n={};e.passengers.forEach(C=>{C.tickets.forEach(f=>{f.promotionCode&&(n[f.promotionCode]=n[f.promotionCode]||{},n[f.promotionCode][C.profile]=n[f.promotionCode][C.profile]||0,++n[f.promotionCode][C.profile])})});let o=this.promotions(),D=[];for(let C of Object.keys(n)){let f=o?.find(M=>M.promotionCode===C);if(f)for(let M of Object.keys(n[C]))D.push({profile:M,promotionName:f.projectName,count:n[C][M]})}return{tickets:D,code:this.promotionCode()}});totalPeople=I(()=>this.trip()?.passengers.length||0);passengerProfiles=I(()=>{let e=this.trip();if(!e)return[];let n={};for(let o of e.passengers)n[o.profile]=(n[o.profile]||0)+1;return Object.entries(n).map(([o,D])=>`${o} ${D}\u5F35`)});totalFare=I(()=>this.trip()?.passengers.reduce((e,n)=>e+n.tickets.reduce((o,D)=>o+parseFloat(D.fare),0),0))};function st(c,e){if(c&1&&(h(0,"div",1),A(1,"i",2),T(2),g()),c&2){let n=e.$implicit;m(2),Ee(" ",n,"")}}function ut(c,e){if(c&1&&(h(0,"div",0),Z(1,st,3,1,"div",1,J),g()),c&2){let n=q();m(),z(n.errors())}}var qe=class c{errors=O([]);messageService=W(Ze);elementRef=W(Me);constructor(){this.messageService.errorComponent=this}focus(){setTimeout(()=>{this.elementRef.nativeElement.scrollIntoView()})}static \u0275fac=function(n){return new(n||c)};static \u0275cmp=P({type:c,selectors:[["app-errors"]],decls:1,vars:1,consts:[[1,"d-flex","flex-column","gap-2","pt-2"],[1,"alert","alert-danger","mb-0","p-2"],[1,"fas","fa-exclamation-circle"]],template:function(n,o){n&1&&G(0,ut,3,0,"div",0),n&2&&R(o.errors().length>0?0:-1)},encapsulation:2})};var de=Se(ve());var Ce=Se(ve());var pt=()=>({standalone:!0}),pe=class c{id=E("");placeholder=E("");disabled=Te(!1);inputClass=E("");buttonClass=E("");value="";date=O(this.dayjsToNgbDate((0,Ce.default)()));writeValue(e){this.value=e,this.tryToUpdateDate(e)}registerOnChange(e){this.onChange=e}registerOnTouched(e){this.onTouched=e}setDisabledState(e){this.disabled.set(e)}onValueChange(e){this.tryToUpdateDate(e),this.value=e,this.onChange(e),this.onTouched()}setDate(e){this.onValueChange(this.ngbDateToString(e))}onChange=()=>{};onTouched=()=>{};tryToUpdateDate(e){let n=(0,Ce.default)(e);n.isValid()&&this.date.set(this.dayjsToNgbDate(n))}dayjsToNgbDate(e){return new Ge(e.year(),e.month()+1,e.date())}ngbDateToString(e){return`${e.year}-${e.month.toString().padStart(2,"0")}-${e.day.toString().padStart(2,"0")}`}static \u0275fac=function(n){return new(n||c)};static \u0275cmp=P({type:c,selectors:[["app-date-input"]],inputs:{id:[1,"id"],placeholder:[1,"placeholder"],disabled:[1,"disabled"],inputClass:[1,"inputClass"],buttonClass:[1,"buttonClass"]},outputs:{disabled:"disabledChange"},features:[Oe([{provide:Fe,useExisting:_e(()=>c),multi:!0}])],decls:6,vars:11,consts:[["d","ngbDatepicker"],[1,"input-group"],["type","text",1,"form-control",3,"change","id","ngClass","value","placeholder","disabled"],["type","hidden","ngbDatepicker","",3,"dateSelect","ngModel","ngModelOptions","positionTarget"],["type","button",1,"input-group-text",3,"click","ngClass","disabled"],[1,"fa-solid","fa-calendar-days"]],template:function(n,o){if(n&1){let D=we();h(0,"div",1)(1,"input",2),re("change",function(f){return te(D),ne(o.onValueChange(f.target.value))}),g(),h(2,"input",3,0),re("dateSelect",function(f){return te(D),ne(o.setDate(f))}),g(),h(4,"button",4),re("click",function(){te(D);let f=Ne(3);return ne(f.toggle())}),A(5,"i",5),g()()}n&2&&(m(),b("id",o.id())("ngClass",o.inputClass())("value",o.value)("placeholder",o.placeholder())("disabled",o.disabled()),m(),b("ngModel",o.date())("ngModelOptions",Ie(10,pt))("positionTarget","#"+o.id()),m(2),b("ngClass",o.buttonClass())("disabled",o.disabled()))},dependencies:[ae,oe,ce,se,le,je,Je,Re],encapsulation:2})};var dt=c=>[c,"p-3","fs-6","m-0","w-100","d-flex","align-items-center"];function mt(c,e){if(c&1&&(h(0,"div",1),T(1),g()),c&2){let n=q();m(),ie(n.title())}}function ft(c,e){if(c&1&&(h(0,"option",9),T(1),g()),c&2){let n=e.$implicit;b("value",n),m(),ie(n)}}function ht(c,e){if(c&1&&(h(0,"option",9),T(1),g()),c&2){let n=e.$implicit;b("value",n),m(),ie(n)}}function gt(c,e){if(c&1&&(h(0,"label",15),T(1,"\u6307\u5B9A\u8ECA\u6B21"),g(),A(2,"input",16)),c&2){let n=q();b("for","tripSectionApointTrainNumber-"+n.autoId()),m(2),b("id","tripSectionApointTrainNumber-"+n.autoId())}}var vt=0,Xe=class c{title=E("");time=E(null);hasTitle=E(!0);hasBorder=E(!0);hasTrainNumber=E(!0);hours=O(Array.from({length:24},(e,n)=>n.toString().padStart(2,"0")));minutes=O(Array.from({length:60},(e,n)=>n.toString().padStart(2,"0")));autoId=O(vt++);form;formBuilder=W(Le);constructor(){this.form=this.formBuilder.group({date:[(0,de.default)().format("YYYY-MM-DD"),ue.required],hour:[(0,de.default)().format("HH"),ue.required],minute:[(0,de.default)().format("mm"),ue.required],searchMethod:[1],apointTrainNumber:[""]}),ke(()=>{let e=this.time();e&&this.form.patchValue({date:e.format("YYYY-MM-DD"),hour:e.format("HH"),minute:e.format("mm")})})}getValues(){return this.form.value}mergeValues(e,n){let o=this.form.value;e[`${n}Date`]=o.date.replaceAll("-","/"),e[`${n}Time`]=`${o.hour}:${o.minute}`,e[`${n}SearchMethod`]=parseInt(o.searchMethod,10),e[`${n}ApointTrainNumber`]=o.apointTrainNumber}static \u0275fac=function(n){return new(n||c)};static \u0275cmp=P({type:c,selectors:[["app-trip-section"]],inputs:{title:[1,"title"],time:[1,"time"],hasTitle:[1,"hasTitle"],hasBorder:[1,"hasBorder"],hasTrainNumber:[1,"hasTrainNumber"]},decls:27,vars:13,consts:[[3,"formGroup"],[1,"border","rounded-top","bg-warning-subtle","p-1"],[3,"ngClass"],[1,"text-nowrap","m-1",3,"for"],[1,"w-25","d-flex","align-items-center","justify-content-start"],[1,"input-group"],["formControlName","date",3,"id"],[1,"d-flex","align-items-center"],["formControlName","hour",1,"form-select","form-select-sm","fs-6","w-auto",3,"id"],[3,"value"],[1,"m-1",3,"for"],["formControlName","minute",1,"form-select","form-select-sm","fs-6","w-auto",3,"id"],["formControlName","searchMethod",1,"form-select","form-select-sm","fs-6"],["value","1"],["value","2"],[1,"text-center","m-1","text-nowrap",3,"for"],["type","text","formControlName","apointTrainNumber",1,"fs-6","form-control","form-control-sm","flex-grow-1",3,"id"]],template:function(n,o){n&1&&(h(0,"form",0),G(1,mt,2,1,"div",1),h(2,"div",2)(3,"label",3),T(4,"\u51FA\u767C\u65E5\u671F"),g(),h(5,"div",4)(6,"div",5),A(7,"app-date-input",6),g()(),h(8,"div",7)(9,"label",3),T(10,"\u51FA\u767C\u6642\u9593"),g(),h(11,"select",8),Z(12,ft,2,2,"option",9,J),g(),h(14,"label",10),T(15,"\u6642"),g(),h(16,"select",11),Z(17,ht,2,2,"option",9,J),g(),h(19,"label",10),T(20,"\u5206"),g()(),h(21,"select",12)(22,"option",13),T(23,"\u4EE5\u51FA\u767C\u6642\u9593\u67E5\u8A62"),g(),h(24,"option",14),T(25,"\u4EE5\u5230\u9054\u6642\u9593\u67E5\u8A62"),g()(),G(26,gt,3,2),g()()),n&2&&(b("formGroup",o.form),m(),R(o.hasTitle()?1:-1),m(),b("ngClass",xe(11,dt,o.hasBorder()?"border shadow-sm":"")),m(),b("for","tripSectionDate-"+o.autoId()),m(4),b("id","tripSectionDate-"+o.autoId()),m(2),b("for","tripSectionHour-"+o.autoId()),m(2),b("id","tripSectionHour-"+o.autoId()),m(),z(o.hours()),m(2),b("for","tripSectionHour-"+o.autoId()),m(2),b("id","tripSectionMinute-"+o.autoId()),m(),z(o.minutes()),m(2),b("for","tripSectionMinute-"+o.autoId()),m(7),R(o.hasTrainNumber()?26:-1))},dependencies:[ae,oe,ce,Ae,Ue,Be,se,Pe,le,Ve,We,Ye,He,pe],styles:["[_nghost-%COMP%]{display:block}.input-group[_ngcontent-%COMP%]{width:153px}"]})};export{ot as a,at as b,ze as c,ve as d,pe as e,Xe as f,qe as g};
