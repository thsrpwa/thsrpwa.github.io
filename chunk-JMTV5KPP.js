import{a as Fe,b as be,c as Q,d as oe,e as ge,f as tn,g as Ne,h as xe,i as ze,j as Je,k as Be,l as nn,m as Ze,n as $e,o as he,p as ve,q as Se,r as on,s as Pe,t as q,u as re,v as z,w as Me,x as Xe,y as Ke,z as ae}from"./chunk-G4T7NWGF.js";import{a as en}from"./chunk-FBFUYCZA.js";import{$ as T,Aa as A,Ba as n,Bb as Xt,Ca as t,Cb as Kt,D as bt,Da as g,Ea as L,Fa as _,Ga as u,Gb as Qe,H as Lt,I as qt,Ja as xt,L as y,Na as Gt,Oa as Ut,Pa as a,Q as Ae,Qa as c,R as D,Ra as P,S as w,Sa as qe,Ta as me,Ua as ie,V as ee,Va as de,Wa as ht,Xa as vt,Y as te,Ya as St,Z as O,_a as yt,a as _e,ab as Et,b as Ue,ba as s,bb as Re,c as yn,cb as Tt,d as Ot,e as jt,eb as Qt,fa as Rt,ga as pe,ha as k,ia as Yt,j as X,ka as Ht,kb as M,m as _t,ma as h,ob as zt,pb as Jt,qa as gt,ra as d,sa as Wt,ta as W,wa as E,wb as Zt,xb as V,y as K,ya as j,za as I}from"./chunk-REHFHUXA.js";var Mt=yn((Dt,wt)=>{"use strict";(function(r,i){typeof Dt=="object"&&typeof wt<"u"?wt.exports=i():typeof define=="function"&&define.amd?define(i):(r=typeof globalThis<"u"?globalThis:r||self).dayjs=i()})(Dt,function(){"use strict";var r=1e3,i=6e4,e=36e5,o="millisecond",l="second",m="minute",N="hour",B="day",ce="week",se="month",Bt="quarter",fe="year",ke="date",$t="Invalid Date",xn=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,hn=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,vn={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(x){var C=["th","st","nd","rd"],p=x%100;return"["+x+(C[(p-20)%10]||C[p]||C[0])+"]"}},ft=function(x,C,p){var b=String(x);return!b||b.length>=C?x:""+Array(C+1-b.length).join(p)+x},Sn={s:ft,z:function(x){var C=-x.utcOffset(),p=Math.abs(C),b=Math.floor(p/60),f=p%60;return(C<=0?"+":"-")+ft(b,2,"0")+":"+ft(f,2,"0")},m:function x(C,p){if(C.date()<p.date())return-x(p,C);var b=12*(p.year()-C.year())+(p.month()-C.month()),f=C.clone().add(b,se),v=p-f<0,S=C.clone().add(b+(v?-1:1),se);return+(-(b+(p-f)/(v?f-S:S-f))||0)},a:function(x){return x<0?Math.ceil(x)||0:Math.floor(x)},p:function(x){return{M:se,y:fe,w:ce,d:B,D:ke,h:N,m,s:l,ms:o,Q:Bt}[x]||String(x||"").toLowerCase().replace(/s$/,"")},u:function(x){return x===void 0}},Oe="en",Te={};Te[Oe]=vn;var Pt="$isDayjsObject",Ct=function(x){return x instanceof We||!(!x||!x[Pt])},He=function x(C,p,b){var f;if(!C)return Oe;if(typeof C=="string"){var v=C.toLowerCase();Te[v]&&(f=v),p&&(Te[v]=p,f=v);var S=C.split("-");if(!f&&S.length>1)return x(S[0])}else{var $=C.name;Te[$]=C,f=$}return!b&&f&&(Oe=f),f||!b&&Oe},Y=function(x,C){if(Ct(x))return x.clone();var p=typeof C=="object"?C:{};return p.date=x,p.args=arguments,new We(p)},F=Sn;F.l=He,F.i=Ct,F.w=function(x,C){return Y(x,{locale:C.$L,utc:C.$u,x:C.$x,$offset:C.$offset})};var We=function(){function x(p){this.$L=He(p.locale,null,!0),this.parse(p),this.$x=this.$x||p.x||{},this[Pt]=!0}var C=x.prototype;return C.parse=function(p){this.$d=function(b){var f=b.date,v=b.utc;if(f===null)return new Date(NaN);if(F.u(f))return new Date;if(f instanceof Date)return new Date(f);if(typeof f=="string"&&!/Z$/i.test(f)){var S=f.match(xn);if(S){var $=S[2]-1||0,R=(S[7]||"0").substring(0,3);return v?new Date(Date.UTC(S[1],$,S[3]||1,S[4]||0,S[5]||0,S[6]||0,R)):new Date(S[1],$,S[3]||1,S[4]||0,S[5]||0,S[6]||0,R)}}return new Date(f)}(p),this.init()},C.init=function(){var p=this.$d;this.$y=p.getFullYear(),this.$M=p.getMonth(),this.$D=p.getDate(),this.$W=p.getDay(),this.$H=p.getHours(),this.$m=p.getMinutes(),this.$s=p.getSeconds(),this.$ms=p.getMilliseconds()},C.$utils=function(){return F},C.isValid=function(){return this.$d.toString()!==$t},C.isSame=function(p,b){var f=Y(p);return this.startOf(b)<=f&&f<=this.endOf(b)},C.isAfter=function(p,b){return Y(p)<this.startOf(b)},C.isBefore=function(p,b){return this.endOf(b)<Y(p)},C.$g=function(p,b,f){return F.u(p)?this[b]:this.set(f,p)},C.unix=function(){return Math.floor(this.valueOf()/1e3)},C.valueOf=function(){return this.$d.getTime()},C.startOf=function(p,b){var f=this,v=!!F.u(b)||b,S=F.p(p),$=function(we,Z){var Ce=F.w(f.$u?Date.UTC(f.$y,Z,we):new Date(f.$y,Z,we),f);return v?Ce:Ce.endOf(B)},R=function(we,Z){return F.w(f.toDate()[we].apply(f.toDate("s"),(v?[0,0,0,0]:[23,59,59,999]).slice(Z)),f)},H=this.$W,U=this.$M,ne=this.$D,Ie="set"+(this.$u?"UTC":"");switch(S){case fe:return v?$(1,0):$(31,11);case se:return v?$(1,U):$(0,U+1);case ce:var De=this.$locale().weekStart||0,je=(H<De?H+7:H)-De;return $(v?ne-je:ne+(6-je),U);case B:case ke:return R(Ie+"Hours",0);case N:return R(Ie+"Minutes",1);case m:return R(Ie+"Seconds",2);case l:return R(Ie+"Milliseconds",3);default:return this.clone()}},C.endOf=function(p){return this.startOf(p,!1)},C.$set=function(p,b){var f,v=F.p(p),S="set"+(this.$u?"UTC":""),$=(f={},f[B]=S+"Date",f[ke]=S+"Date",f[se]=S+"Month",f[fe]=S+"FullYear",f[N]=S+"Hours",f[m]=S+"Minutes",f[l]=S+"Seconds",f[o]=S+"Milliseconds",f)[v],R=v===B?this.$D+(b-this.$W):b;if(v===se||v===fe){var H=this.clone().set(ke,1);H.$d[$](R),H.init(),this.$d=H.set(ke,Math.min(this.$D,H.daysInMonth())).$d}else $&&this.$d[$](R);return this.init(),this},C.set=function(p,b){return this.clone().$set(p,b)},C.get=function(p){return this[F.p(p)]()},C.add=function(p,b){var f,v=this;p=Number(p);var S=F.p(b),$=function(U){var ne=Y(v);return F.w(ne.date(ne.date()+Math.round(U*p)),v)};if(S===se)return this.set(se,this.$M+p);if(S===fe)return this.set(fe,this.$y+p);if(S===B)return $(1);if(S===ce)return $(7);var R=(f={},f[m]=i,f[N]=e,f[l]=r,f)[S]||1,H=this.$d.getTime()+p*R;return F.w(H,this)},C.subtract=function(p,b){return this.add(-1*p,b)},C.format=function(p){var b=this,f=this.$locale();if(!this.isValid())return f.invalidDate||$t;var v=p||"YYYY-MM-DDTHH:mm:ssZ",S=F.z(this),$=this.$H,R=this.$m,H=this.$M,U=f.weekdays,ne=f.months,Ie=f.meridiem,De=function(Z,Ce,Le,Ge){return Z&&(Z[Ce]||Z(b,v))||Le[Ce].slice(0,Ge)},je=function(Z){return F.s($%12||12,Z,"0")},we=Ie||function(Z,Ce,Le){var Ge=Z<12?"AM":"PM";return Le?Ge.toLowerCase():Ge};return v.replace(hn,function(Z,Ce){return Ce||function(Le){switch(Le){case"YY":return String(b.$y).slice(-2);case"YYYY":return F.s(b.$y,4,"0");case"M":return H+1;case"MM":return F.s(H+1,2,"0");case"MMM":return De(f.monthsShort,H,ne,3);case"MMMM":return De(ne,H);case"D":return b.$D;case"DD":return F.s(b.$D,2,"0");case"d":return String(b.$W);case"dd":return De(f.weekdaysMin,b.$W,U,2);case"ddd":return De(f.weekdaysShort,b.$W,U,3);case"dddd":return U[b.$W];case"H":return String($);case"HH":return F.s($,2,"0");case"h":return je(1);case"hh":return je(2);case"a":return we($,R,!0);case"A":return we($,R,!1);case"m":return String(R);case"mm":return F.s(R,2,"0");case"s":return String(b.$s);case"ss":return F.s(b.$s,2,"0");case"SSS":return F.s(b.$ms,3,"0");case"Z":return S}return null}(Z)||S.replace(":","")})},C.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},C.diff=function(p,b,f){var v,S=this,$=F.p(b),R=Y(p),H=(R.utcOffset()-this.utcOffset())*i,U=this-R,ne=function(){return F.m(S,R)};switch($){case fe:v=ne()/12;break;case se:v=ne();break;case Bt:v=ne()/3;break;case ce:v=(U-H)/6048e5;break;case B:v=(U-H)/864e5;break;case N:v=U/e;break;case m:v=U/i;break;case l:v=U/r;break;default:v=U}return f?v:F.a(v)},C.daysInMonth=function(){return this.endOf(se).$D},C.$locale=function(){return Te[this.$L]},C.locale=function(p,b){if(!p)return this.$L;var f=this.clone(),v=He(p,b,!0);return v&&(f.$L=v),f},C.clone=function(){return F.w(this.$d,this)},C.toDate=function(){return new Date(this.valueOf())},C.toJSON=function(){return this.isValid()?this.toISOString():null},C.toISOString=function(){return this.$d.toISOString()},C.toString=function(){return this.$d.toUTCString()},x}(),Vt=We.prototype;return Y.prototype=Vt,[["$ms",o],["$s",l],["$m",m],["$H",N],["$W",B],["$M",se],["$y",fe],["$D",ke]].forEach(function(x){Vt[x[1]]=function(C){return this.$g(C,x[0],x[1])}}),Y.extend=function(x,C){return x.$i||(x(C,We,Y),x.$i=!0),Y},Y.locale=He,Y.isDayjs=Ct,Y.unix=function(x){return Y(1e3*x)},Y.en=Te[Oe],Y.Ls=Te,Y.p={},Y})});var et=class r{router=y(Kt);goToGeneralBooking(){this.redirectTo("/mmi/tickets/new")}goToBookingRecord(){this.router.navigate(["/mmi/tickets/new"],{queryParams:{test:1}})}exit(){this.router.navigate(["/mmi/main"])}redirectTo(i){this.router.navigateByUrl("/",{skipLocationChange:!0}).then(()=>{this.router.navigate([i])})}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=k({type:r,selectors:[["app-tickets-head-buttons"]],decls:13,vars:0,consts:[[1,"bg-secondary","text-white","text-nowrap","d-flex","p-3"],["tabindex","-1",1,"btn","btn-primary","btn-lg","flex-1","fs-6",3,"click"],["tabindex","-1",1,"btn","btn-dark","btn-lg","flex-1","fs-6","ms-2",3,"click"],["tabindex","-1",1,"btn","btn-dark","btn-lg","flex-1","fs-6","ms-2"],["tabindex","-1",1,"btn","btn-outline-primary","btn-lg","flex-1","fs-6","ms-4",3,"click"]],template:function(e,o){e&1&&(n(0,"div",0)(1,"button",1),_("click",function(){return o.goToGeneralBooking()}),a(2,"\u4E00\u822C\u8A02\u4F4D"),t(),n(3,"button",2),_("click",function(){return o.goToBookingRecord()}),a(4," \u8A02\u4F4D\u7D00\u9304\u4FEE\u6539\uFF0F\u53D6\u7968 "),t(),n(5,"button",3),a(6,"\u81EA\u7531\u5EA7(\u6307\u5B9A\u8ECA\u6B21)"),t(),n(7,"button",3),a(8,"\u6642\u523B\u8868"),t(),n(9,"button",3),a(10,"\u958B\u653E\u8A02\u4F4D\u65E5\u671F\u67E5\u8A62"),t(),n(11,"button",4),_("click",function(){return o.exit()}),a(12,"\u56DE\u4E3B\u756B\u9762"),t()())},dependencies:[Qe],styles:[".flex-1[_ngcontent-%COMP%]{flex:1}"]})};var tt=class r{static \u0275fac=function(e){return new(e||r)};static \u0275cmp=k({type:r,selectors:[["app-tickets"]],decls:3,vars:0,consts:[[1,"container"]],template:function(e,o){e&1&&(g(0,"app-tickets-head-buttons"),n(1,"main",0),g(2,"router-outlet"),t())},dependencies:[Xt,et],styles:["[_nghost-%COMP%]{display:block;height:100%}"]})};var ue=Ot(Mt());var kt=(e=>(e[e.general=1]="general",e[e.group=2]="group",e))(kt||{});function En(r,i){if(r&1){let e=L();n(0,"button",7),_("click",function(){D(e);let l=u();return w(l.ngbActiveModal.close(null))}),t()}}function Tn(r,i){if(r&1){let e=L();n(0,"button",8),_("click",function(){D(e);let l=u();return w(l.ngbActiveModal.close(!1))}),a(1),t()}if(r&2){let e=u();s(),c(e.cancelText())}}var nt=class r{title=T("");message=T("");cancelText=T("\u53D6\u6D88");confirmText=T("\u78BA\u8A8D");confirmation=T(!1);hasClose=T(!1);ngbActiveModal=y(Xe);static \u0275fac=function(e){return new(e||r)};static \u0275cmp=k({type:r,selectors:[["app-message-modal"]],decls:11,vars:5,consts:[[1,"modal-header","bg-warning-subtle"],[1,"modal-title"],["type","button","aria-label","Close",1,"btn-close"],[1,"modal-body"],[1,"modal-footer","justify-content-center"],["type","button",1,"btn","btn-secondary"],["type","button",1,"btn","btn-primary",3,"click"],["type","button","aria-label","Close",1,"btn-close",3,"click"],["type","button",1,"btn","btn-secondary",3,"click"]],template:function(e,o){e&1&&(n(0,"div",0)(1,"h5",1),a(2),t(),h(3,En,1,0,"button",2),t(),n(4,"div",3)(5,"p"),a(6),t()(),n(7,"div",4),h(8,Tn,2,1,"button",5),n(9,"button",6),_("click",function(){return o.ngbActiveModal.close(!0)}),a(10),t()()),e&2&&(s(2),c(o.title()),s(),E(o.hasClose()?3:-1),s(3),c(o.message()),s(2),E(o.confirmation()?8:-1),s(2),c(o.confirmText()))},encapsulation:2})};var rn={1001:"\u6E2C\u8A66\u932F\u8AA4 1001",3001:"\u6E2C\u8A66\u932F\u8AA4 3001"},an={1001:"\u6A19\u984C 1001",3001:"\u6A19\u984C 3001"};var le=class r{errorComponent;ngbModal=y(Ke);show(i){let e=this.ngbModal.open(nt,{size:"sm",centered:!0,backdrop:"static"});return e.componentInstance.title.set(i.title),e.componentInstance.message.set(i.message),e.componentInstance.confirmation.set(i.confirmation??!1),e.componentInstance.cancelText.set(i.cancelText??"\u53D6\u6D88"),e.componentInstance.confirmText.set(i.confirmText??"\u78BA\u8A8D"),e.componentInstance.hasClose.set(i.hasClose??!1),e}processCodes(i){let e=[],o=[];for(let m of i){let N=an[m.errorCode]||`\u932F\u8AA4\u4EE3\u78BC ${m.errorCode}`,B=rn[m.errorCode]||`\u932F\u8AA4\u4EE3\u78BC ${m.errorCode}`;m.errorCode>=1001&&m.errorCode<=2999?e.push(B):m.errorCode>=3e3&&m.errorCode<=3999?o.push({code:m,messageOption:{title:N,message:B}}):m.errorCode>=4e3&&m.errorCode<=5999&&o.push({code:m,messageOption:{title:N,message:B,confirmation:!0,hasClose:m.errorActionCode.length===3}})}this.setErrors(e);let l=null;return o.length&&(l=this.show(o[0].messageOption)),{textErrors:e,modalErrors:o,anyError:e.length||o.length,modelRef:l}}setErrors(i){console.log(this.errorComponent),this.errorComponent?.errors?.set(i)}static \u0275fac=function(e){return new(e||r)};static \u0275prov=Lt({token:r,factory:r.\u0275fac,providedIn:"root"})};var ln={code:null,message:null,data:{departStationList:["\u5357\u6E2F","\u53F0\u5317","\u677F\u6A4B","\u6843\u5712","\u65B0\u7AF9","\u82D7\u6817","\u53F0\u4E2D","\u5F70\u5316","\u96F2\u6797","\u5609\u7FA9","\u53F0\u5357","\u5DE6\u71DF"],arrivalStationList:["\u5357\u6E2F","\u53F0\u5317","\u677F\u6A4B","\u6843\u5712","\u65B0\u7AF9","\u82D7\u6817","\u53F0\u4E2D","\u5F70\u5316","\u96F2\u6797","\u5609\u7FA9","\u53F0\u5357","\u5DE6\u71DF"],profile:[{content:"\u6210\u4EBA",code:"F",isEnable:!0},{content:"\u5B69\u7AE5",code:"H",isEnable:!0},{content:"\u611B\u5FC3",code:"W",isEnable:!0},{content:"\u656C\u8001",code:"E",isEnable:!0},{content:"\u5B78\u751F",code:"P",isEnable:!0},{content:"\u7279\u60E0\u5168",code:"S",isEnable:!0},{content:"\u7279\u60E0\u534A",code:"M",isEnable:!0}],classType:["\u6A19\u6E96\u8ECA\u5EC2","\u5546\u52D9\u8ECA\u5EC2","\u8F2A\u6905\u5EA7\u4F4D"],sellingDate:{},promotionOfProjectData:{promotionTypeList:[{id:0,name:"\u6240\u6709\u5206\u985E"},{id:1,name:"\u516C\u52D9\u4E58\u8ECA"},{id:2,name:"\u4F01\u696D\u6703\u54E1"},{id:3,name:"\u5176\u4ED6"}],promotionDataList:[{promotionCode:"P001",projectName:"\u516C\u52D9\u4E58\u8ECA",projectDiscount:"0",promotionTypeId:1,cancel_group_reservation:!0,voucherNumberRequired:!0,accumulateCorporateMembers:!0,accumulateMembers:!0,onlyManualSelection:!0,adultChildId:!0,tweList:!0},{promotionCode:"P115",projectName:"\u4F01\u696D\u6703\u54E1",projectDiscount:"-100",promotionTypeId:2,cancel_group_reservation:!0,voucherNumberRequired:!0,accumulateCorporateMembers:!0,accumulateMembers:!0,onlyManualSelection:!0,adultChildId:!0,roundTripAvailabled:!0,tweList:!1}]}}};var sn={code:[{errorCode:0,errorActionCode:null}],message:null,data:{outbound:[{index:1,isTick:!0,available:!0,trainNumber:"2855",departDate:"11/08",departTime:"07:00",arrivalDate:"11/08",arrivalTime:"08:00",elapseTime:"00:54",aVLSeatCount:"Y8",trainDiscount:"Y",projects:[{name:"\u5B78\u751F88",colorCode:"C1BE45"},{name:"\u5C11\u5E7488",colorCode:"C1BE45"}]},{index:2,isTick:!0,available:!0,trainNumber:"2855",departDate:"11/08",departTime:"08:00",arrivalDate:"11/08",arrivalTime:"09:00",elapseTime:"00:54",aVLSeatCount:"Y8",trainDiscount:"Y",projects:[{name:"\u5B78\u751F88",colorCode:"C1BE45"},{name:"\u5C11\u5E7488",colorCode:"C1BE45"}]},{index:3,isTick:!0,available:!0,trainNumber:"2855",departDate:"11/08",departTime:"23:00",arrivalDate:"11/09",arrivalTime:"00:05",elapseTime:"00:54",aVLSeatCount:"Y8",trainDiscount:"Y",projects:[{name:"\u5B78\u751F88",colorCode:"C1BE45"},{name:"\u5C11\u5E7488",colorCode:"C1BE45"}]}],inbound:[{index:1,isTick:!0,available:!0,trainNumber:"2855",departDate:"11/08",departTime:"09:00",arrivalDate:"11/08",arrivalTime:"10:00",elapseTime:"00:54",avlSeatCount:"Y8",trainDiscount:"Y",projects:[{name:"\u5B78\u751F88",colorCode:"C1BE45"}]},{index:2,isTick:!0,available:!0,trainNumber:"2855",departDate:"11/08",departTime:"10:00",arrivalDate:"11/08",arrivalTime:"11:00",elapseTime:"00:54",avlSeatCount:"Y8",trainDiscount:"Y",projects:[{name:"\u5B78\u751F88",colorCode:"C1BE45"}]},{index:3,isTick:!0,available:!0,trainNumber:"2855",departDate:"11/08",departTime:"10:00",arrivalDate:"11/08",arrivalTime:"11:00",elapseTime:"00:54",aVLSeatCount:"Y8",trainDiscount:"Y",projects:[{name:"\u5B78\u751F88",colorCode:"C1BE45"},{name:"\u5C11\u5E7488",colorCode:"C1BE45"}]},{index:4,isTick:!0,available:!0,trainNumber:"2855",departDate:"11/08",departTime:"10:00",arrivalDate:"11/08",arrivalTime:"11:00",elapseTime:"00:54",aVLSeatCount:"Y8",trainDiscount:"Y",projects:[{name:"\u5B78\u751F88",colorCode:"C1BE45"},{name:"\u5C11\u5E7488",colorCode:"C1BE45"}]},{index:5,isTick:!0,available:!0,trainNumber:"2855",departDate:"11/08",departTime:"10:00",arrivalDate:"11/08",arrivalTime:"11:00",elapseTime:"00:54",aVLSeatCount:"Y8",trainDiscount:"Y",projects:[{name:"\u5B78\u751F88",colorCode:"C1BE45"},{name:"\u5C11\u5E7488",colorCode:"C1BE45"}]},{index:6,isTick:!0,available:!0,trainNumber:"2855",departDate:"11/08",departTime:"10:00",arrivalDate:"11/08",arrivalTime:"11:00",elapseTime:"00:54",aVLSeatCount:"Y8",trainDiscount:"Y",projects:[{name:"\u5B78\u751F88",colorCode:"C1BE45"},{name:"\u5C11\u5E7488",colorCode:"C1BE45"}]},{index:7,isTick:!0,available:!0,trainNumber:"2855",departDate:"11/08",departTime:"10:00",arrivalDate:"11/08",arrivalTime:"11:00",elapseTime:"00:54",aVLSeatCount:"Y8",trainDiscount:"Y",projects:[{name:"\u5B78\u751F88",colorCode:"C1BE45"},{name:"\u5C11\u5E7488",colorCode:"C1BE45"}]},{index:8,isTick:!0,available:!0,trainNumber:"2855",departDate:"11/08",departTime:"10:00",arrivalDate:"11/08",arrivalTime:"11:00",elapseTime:"00:54",aVLSeatCount:"Y8",trainDiscount:"Y",projects:[{name:"\u5B78\u751F88",colorCode:"C1BE45"},{name:"\u5C11\u5E7488",colorCode:"C1BE45"}]},{index:9,isTick:!0,available:!0,trainNumber:"2855",departDate:"11/08",departTime:"10:00",arrivalDate:"11/08",arrivalTime:"11:00",elapseTime:"00:54",aVLSeatCount:"Y8",trainDiscount:"Y",projects:[{name:"\u5B78\u751F88",colorCode:"C1BE45"},{name:"\u5C11\u5E7488",colorCode:"C1BE45"}]},{index:10,isTick:!0,available:!0,trainNumber:"2855",departDate:"11/08",departTime:"10:00",arrivalDate:"11/08",arrivalTime:"11:00",elapseTime:"00:54",aVLSeatCount:"Y8",trainDiscount:"Y",projects:[{name:"\u5B78\u751F88",colorCode:"C1BE45"},{name:"\u5C11\u5E7488",colorCode:"C1BE45"}]},{index:11,isTick:!0,available:!0,trainNumber:"2855",departDate:"11/08",departTime:"10:00",arrivalDate:"11/08",arrivalTime:"11:00",elapseTime:"00:54",aVLSeatCount:"Y8",trainDiscount:"Y",projects:[{name:"\u5B78\u751F88",colorCode:"C1BE45"},{name:"\u5C11\u5E7488",colorCode:"C1BE45"}]},{index:12,isTick:!0,available:!0,trainNumber:"2855",departDate:"11/08",departTime:"10:00",arrivalDate:"11/08",arrivalTime:"11:00",elapseTime:"00:54",aVLSeatCount:"Y8",trainDiscount:"Y",projects:[{name:"\u5B78\u751F88",colorCode:"C1BE45"},{name:"\u5C11\u5E7488",colorCode:"C1BE45"}]}],promotion:{code:"P001",projectName:"\u516C\u52D9\u4E58\u8ECA",projectDiscount:"-100"}}};var mn={individualMember:{memberName:"\u738B\u5C0F\u660E",membeLevel:"\u666E\u5361",memberGender:"\u5148\u751F/\u5C0F\u59D0",memberCardID:"GA11114668"},corporateMember:{companyName:"\u795E\u901A\u8CC7\u8A0A\u79D1\u6280\u80A1\u4EFD\u6709\u9650\u516C\u53F8",isMember:"\u6703\u54E1"}};var ye=class r{disabled=O(!1);personalId=pe("");coperateId=pe("");showing=T(!1);enabledPidCheck=M(()=>!this.disabled()&&(this.personalId()||this.coperateId()));loadingService=y(ae);messageService=y(le);destroyRef=y(ee);onPidCheck(){if(this.loadingService.loading)return;this.loadingService.start();let i={membership:{personalId:this.personalId(),coperateId:this.coperateId()}};this.request(i).pipe(z(this.destroyRef)).subscribe({next:e=>{this.loadingService.stop();let o="",l="";this.coperateId()?(o="\u4F01\u696D\u6703\u54E1",l=e.corporateMember.companyName):(o=`\u500B\u4EBA\u6703\u54E1-${e.individualMember.membeLevel}`,l=`${e.individualMember.memberName} ${e.individualMember.memberGender}`),this.messageService.show({title:o,message:l}),this.showing.set(!0)},error:e=>{console.error(e),this.loadingService.stop()},complete:()=>{this.loadingService.stop()}})}request(i){return console.log(i),X(mn).pipe(K(100))}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=k({type:r,selectors:[["app-member-code"]],inputs:{disabled:[1,"disabled"],personalId:[1,"personalId"],coperateId:[1,"coperateId"]},outputs:{personalId:"personalIdChange",coperateId:"coperateIdChange"},decls:12,vars:6,consts:[[1,"w-100","d-flex","align-items-center"],["for","coperateId",1,"text-nowrap","m-1"],[1,"m-1"],["id","coperateId",1,"form-control","form-control-sm","fs-6",3,"ngModelChange","ngModel","disabled"],["for","personalId",1,"text-nowrap","m-1"],["id","personalId",1,"form-control","form-control-sm","fs-6",3,"ngModelChange","ngModel","disabled"],["type","button",1,"btn","btn-secondary","btn-sm","fs-6",3,"click","disabled"]],template:function(e,o){e&1&&(n(0,"div",0)(1,"label",1),a(2,"\u4F01\u696D\u6703\u54E1\u7DE8\u865F"),t(),n(3,"div",2)(4,"input",3),_("ngModelChange",function(m){return o.coperateId.set(m)}),t()(),n(5,"label",4),a(6,"\u500B\u4EBA\u6703\u54E1\u7DE8\u865F"),t(),n(7,"div",2)(8,"input",5),_("ngModelChange",function(m){return o.personalId.set(m)}),t()(),n(9,"div",2)(10,"button",6),_("click",function(){return o.onPidCheck()}),a(11),t()()()),e&2&&(s(4),d("ngModel",o.coperateId())("disabled",o.disabled()||!!o.personalId()),s(4),d("ngModel",o.personalId())("disabled",o.disabled()||!!o.coperateId()),s(2),d("disabled",!o.enabledPidCheck()),s(),P(" ",o.showing()?"\u986F\u793A\u4E2D":"PID\u6703\u54E1\u8CC7\u6599\u6AA2\u6838/\u986F\u793A"," "))},dependencies:[V,q,be,oe,Ne],encapsulation:2})};var wn=(r,i)=>i.code,Mn=(r,i)=>i.name,kn=(r,i)=>i.id,In=(r,i)=>i.promotionCode;function An(r,i){if(r&1&&(n(0,"option",6),a(1),t()),r&2){let e=i.$implicit;d("value",e),s(),c(e)}}function Fn(r,i){if(r&1&&(n(0,"option",6),a(1),t()),r&2){let e=i.$implicit;d("value",e),s(),c(e)}}function Nn(r,i){if(r&1&&(n(0,"div",16)(1,"label",52),a(2),t(),g(3,"input",53),t()),r&2){let e=i.$implicit,o=i.$index;s(),d("for","profile-"+e.code),s(),c(e.content),s(),d("id","profile-"+e.code)("formControlName",o)}}function Bn(r,i){if(r&1&&(n(0,"div",7),g(1,"input",54),n(2,"label",55),a(3),t()()),r&2){let e=i.$implicit;s(),xt("id","classType-",e.value,""),d("formControlName","classType")("value",e.value),gt("disabled",e.disabled?"true":null),s(),xt("for","classType-",e.value,""),s(),c(e.name)}}function $n(r,i){if(r&1&&(n(0,"option",6),a(1),t()),r&2){let e=i.$implicit;d("value",e),s(),c(e)}}function Pn(r,i){if(r&1&&(n(0,"option",6),a(1),t()),r&2){let e=i.$implicit;d("value",e),s(),c(e)}}function Vn(r,i){if(r&1&&(n(0,"option",6),a(1),t()),r&2){let e=i.$implicit;d("value",e),s(),c(e)}}function On(r,i){if(r&1&&(n(0,"option",6),a(1),t()),r&2){let e=i.$implicit;d("value",e),s(),c(e)}}function jn(r,i){if(r&1&&(n(0,"div",19),a(1,"\u56DE\u7A0B"),t(),n(2,"div",20)(3,"label",56),a(4,"\u51FA\u767C\u65E5\u671F"),t(),n(5,"div",22),g(6,"input",57),t(),n(7,"div",24)(8,"label",58),a(9,"\u51FA\u767C\u6642\u9593"),t(),n(10,"select",59),I(11,Vn,2,2,"option",6,j),t(),n(13,"label",60),a(14,"\u6642"),t(),n(15,"select",61),I(16,On,2,2,"option",6,j),t(),n(18,"label",62),a(19,"\u5206"),t()(),n(20,"select",63)(21,"option",31),a(22,"\u4EE5\u51FA\u767C\u6642\u9593\u67E5\u8A62"),t(),n(23,"option",32),a(24,"\u4EE5\u5230\u9054\u6642\u9593\u67E5\u8A62"),t()(),n(25,"label",64),a(26,"\u6307\u5B9A\u8ECA\u6B21"),t(),g(27,"input",65),t()),r&2){let e=u();s(11),A(e.hours()),s(5),A(e.minutes())}}function Ln(r,i){if(r&1&&(n(0,"option",6),a(1),t()),r&2){let e=i.$implicit;d("value",e.id),s(),c(e.name)}}function qn(r,i){if(r&1&&(n(0,"option",6),a(1),t()),r&2){let e=i.$implicit;d("value",e.promotionCode),s(),c(e.projectName)}}var dn=[{content:"\u6210\u4EBA",code:"F",isEnable:!0},{content:"\u5B69\u7AE5",code:"H",isEnable:!0},{content:"\u611B\u5FC3",code:"W",isEnable:!0},{content:"\u656C\u8001",code:"E",isEnable:!0},{content:"\u5B78\u751F",code:"P",isEnable:!0},{content:"\u7279\u60E0\u5168",code:"S",isEnable:!0},{content:"\u7279\u60E0\u534A",code:"M",isEnable:!0}],pn=[{name:"\u6A19\u6E96\u8ECA\u5EC2",value:1,disabled:!1},{name:"\u5546\u52D9\u8ECA\u5EC2",value:2,disabled:!1},{name:"\u8F2A\u6905\u5EA7\u4F4D",value:3,disabled:!1}],it=class r{confirm=te();promotions=te();bookingType=kt;form;profiles=T(dn);departStationList=T([]);arrivalStationList=T([]);totalPeople;classType;classTypes=T(pn);promotionTypeList=T([]);promotionDataList=T([]);hours=T(Array.from({length:24},(i,e)=>e.toString().padStart(2,"0")));minutes=T(Array.from({length:60},(i,e)=>e.toString().padStart(2,"0")));promotionType;promotionList;roundTrip;personalId=T("");coperateId=T("");selectedPromotion;filteredPromotionDataList=M(()=>{let i=this.promotionType();return this.promotionDataList().filter(e=>e.promotionTypeId===i)});disableGernalBook=M(()=>this.totalPeople()>10);disableGroupBook=M(()=>this.roundTrip()||this.classType()===3||this.selectedPromotion()?.cancel_group_reservation);formBuilder=y(Pe);loadingService=y(ae);messageService=y(le);destroyRef=y(ee);constructor(){this.form=this.formBuilder.group({profiles:this.formBuilder.array(dn.map(()=>this.formBuilder.control(null))),departStation:[null,Q.required],arrivalStation:[null,Q.required],classType:[pn[0].value,Q.required],roundTrip:[!1],departDate:[(0,ue.default)().format("YYYY-MM-DD"),Q.required],departHour:[(0,ue.default)().format("HH"),Q.required],departMinute:[(0,ue.default)().format("mm"),Q.required],departSearchMethod:[1],departApointTrainNumber:[null],returnDate:[(0,ue.default)().add(1,"day").format("YYYY-MM-DD"),Q.required],returnHour:[(0,ue.default)().format("HH"),Q.required],returnMinute:[(0,ue.default)().format("mm"),Q.required],returnSearchMethod:[1],returnApointTrainNumber:[null],promotionType:[0],promotionCodeList:[""],promotionCode:[null]}),this.promotionType=Me(this.form.get("promotionType").valueChanges.pipe(_t(e=>parseInt(e,10)),bt(()=>this.form.patchValue({promotionCodeList:""}))),{initialValue:0}),this.promotionList=Me(this.form.get("promotionCodeList").valueChanges.pipe(bt(e=>this.form.patchValue({promotionCode:e}))),{initialValue:""}),this.totalPeople=Me(this.form.valueChanges.pipe(_t(()=>this.form.get("profiles").controls.reduce((e,o)=>e+(o.value||0),0))),{initialValue:0}),this.roundTrip=Me(this.form.get("roundTrip").valueChanges),this.classType=Me(this.form.get("classType").valueChanges);let i=Me(this.form.get("promotionCode").valueChanges);this.selectedPromotion=M(()=>this.promotionDataList().find(o=>o.promotionCode===i())),this.loadingService.start(),this.request().pipe(z(this.destroyRef)).subscribe({next:e=>{this.loadingService.stop(),this.departStationList.set(e.data.departStationList),this.arrivalStationList.set(e.data.arrivalStationList),this.promotionTypeList.set(e.data.promotionOfProjectData.promotionTypeList),this.promotionDataList.set(e.data.promotionOfProjectData.promotionDataList),this.profiles.set(e.data.profile),this.form.setControl("profiles",this.formBuilder.array(e.data.profile.map(()=>this.formBuilder.control(null)))),this.classTypes.update(o=>(o.forEach(l=>{let m=e.data.classType.find(N=>N===l.name);l.disabled=!m}),o)),this.form.patchValue({departStation:this.departStationList()[0],arrivalStation:this.arrivalStationList()[1]}),this.promotions.emit(e.data.promotionOfProjectData.promotionDataList)},error:e=>{console.error(e),this.loadingService.stop()},complete:()=>{this.loadingService.stop()}})}swapStation(){let i=this.form.get("departureStation")?.value,e=this.form.get("arrivalStation")?.value;this.form.get("departureStation")?.setValue(e),this.form.get("arrivalStation")?.setValue(i)}onSubmit(i){if(this.loadingService.loading)return;this.loadingService.start();let e=Ue(_e({},this.form.value),{bookingType:i});e.tripType=e.roundTrip?2:1,e.profile=this.getProfiles(),e.membership={personalId:e.personalId,coperateId:e.coperateId},e.departTime=`${e.departHour}:${e.departMinute}`,e.returnTime=`${e.returnHour}:${e.returnMinute}`,e.allTrain=0,e.requeryTrain=!1,e.personalId=this.personalId(),e.coperateId=this.coperateId(),["profiles","promotionType","promotionCodeList","roundTrip","departHour","departMinute","returnHour","returnMinute"].forEach(o=>{delete e[o]}),this.request2(e).pipe(z(this.destroyRef)).subscribe({next:o=>{this.loadingService.stop();let{anyError:l}=this.messageService.processCodes(o.code);l||this.confirm.emit({query:e,data:o.data})},error:o=>{console.error(o),this.loadingService.stop()},complete:()=>{this.loadingService.stop()}})}validate(){let i=[];this.form.get("departStation")?.value===this.form.get("arrivalStation")?.value&&i.push("\u51FA\u767C\u7AD9\u8207\u5230\u9054\u7AD9\u9700\u4E0D\u540C");let e=this.getProfiles();e.length>4&&i.push("\u6700\u591A\u53EA\u80FD\u540C\u6642\u8CFC\u8CB7\u56DB\u7A2E\u8EAB\u5206\u5225"),e.length<1&&i.push("\u81F3\u5C11\u9700\u8F38\u5165\u4E00\u500B\u8EAB\u5206\u5225\u7684\u5F35\u6578");let o=Math.max(...e.map(N=>N.quantity));this.form.get("roundTrip")?.value&&o>5&&i.push("\u4E00\u822C\u8A02\u4F4D\u53BB\u56DE\u7A0B\u6700\u591A\u50C5\u80FD\u9078\u64C75\u5F35\u7968");let l=(0,ue.default)(`${this.form.get("departDate")?.value} ${this.form.get("departHour")?.value}:${this.form.get("departMinute")?.value}`),m=(0,ue.default)(`${this.form.get("returnDate")?.value} ${this.form.get("returnHour")?.value}:${this.form.get("returnMinute")?.value}`);return(m.isBefore(l)||m.isSame(l))&&i.push("\u8A02\u8CFC\u53BB\u56DE\u7A0B\uFF0C\u56DE\u7A0B\u6642\u9593\u65E9\u65BC\u53BB\u7A0B\u6642\u9593"),e.some(N=>N.code==="P")&&this.form.get("classType").value===2&&i.push("\u5B78\u751F\u7968\u4E0D\u9069\u7528\u5546\u52D9\u8ECA\u5EC2\uFF0C\u8ACB\u91CD\u65B0\u9078\u64C7"),i}getProfiles(){let i=this.profiles();return this.form.get("profiles").value.map((e,o)=>({code:i[o].code,quantity:e})).filter(e=>e.quantity)}request(){return X(ln).pipe(K(100))}request2(i){return console.log(i),X(sn).pipe(K(100))}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=k({type:r,selectors:[["app-step1"]],outputs:{confirm:"confirm",promotions:"promotions"},decls:95,vars:8,consts:[[1,"py-2",3,"formGroup"],[1,"border","rounded","p-3","shadow-sm","bg-white","fs-6","m-0","w-100"],[1,"row","mb-2","align-items-center","w-100"],["for","departStation",1,"col-auto"],[1,"col"],["id","departStation","formControlName","departStation",1,"form-select","form-select-sm","fs-6"],[3,"value"],[1,"col-auto"],["href","javascript:;",3,"click"],[1,"fa-solid","fa-right-left"],["for","arrivalStation",1,"col-auto"],["id","arrivalStation","formControlName","arrivalStation",1,"form-select","form-select-sm","fs-6"],["type","checkbox","id","roundTrip","formControlName","roundTrip",1,"form-check-input","me-1","fs-6"],["for","roundTrip",1,"form-check-label"],[1,"col-auto","text-end","text-warning"],["formArrayName","profiles",1,"row","mb-2","align-items-center","w-100"],[1,"col","d-flex","align-items-center","p-0","me-3"],[1,"row","mb-2","w-100"],[3,"personalIdChange","coperateIdChange"],[1,"w-100","border","rounded-top","bg-warning-subtle","mt-2","p-1"],[1,"border","p-3","shadow-sm","fs-6","m-0","w-100","d-flex","align-items-center"],["for","departDate",1,"text-nowrap","m-1"],[1,"w-25","d-flex","align-items-center","justify-content-start"],["type","date","id","departDate","formControlName","departDate",1,"form-control","fs-6"],[1,"d-flex","align-items-center"],["for","departHour",1,"text-nowrap","m-1"],["id","departHour","formControlName","departHour",1,"form-select","form-select-sm","fs-6","w-auto"],["for","departHour",1,"m-1"],["id","departMinute","formControlName","departMinute",1,"form-select","form-select-sm","fs-6","w-auto"],["for","departMinute",1,"m-1"],["formControlName","departSearchMethod",1,"form-select","form-select-sm","fs-6"],["value","1"],["value","2"],["for","departApointTrainNumber",1,"text-center","m-1","text-nowrap"],["type","text","id","departApointTrainNumber","formControlName","departApointTrainNumber",1,"fs-6","form-control","form-control-sm","flex-grow-1"],[1,"border","rounded","shadow-sm","mt-2","p-3","fs-6"],[1,"d-flex","flex-wrap","align-items-center","justify-content-between"],[1,"border","rounded","d-flex","align-items-center","px-2","py-1","flex-grow-1","me-2"],[1,"d-flex","align-items-center","me-3","w-50"],["for","promotionType",1,"me-2","text-nowrap"],["id","promotionType","formControlName","promotionType",1,"form-select","form-select-sm","w-100"],[1,"d-flex","align-items-center","w-50"],["for","promotionCodeList",1,"me-2","text-nowrap"],["id","promotionCodeList","formControlName","promotionCodeList",1,"form-select","form-select-sm","w-100"],["value",""],[1,"mx-2"],[1,"border","rounded","d-flex","align-items-center","px-2","py-1",2,"min-width","250px"],["for","promotionCode",1,"me-2","text-nowrap"],["type","text","id","promotionCode","formControlName","promotionCode",1,"form-control","form-control-sm"],[1,"d-flex","align-items-center","gap-2","fs-6","w-100","justify-content-center","mt-2"],["type","button",1,"btn","bg-primary","text-white","px-4",3,"click","disabled"],["type","button",1,"btn","btn-secondary","px-4",3,"click","disabled"],[1,"text-center","text-nowrap","me-1",3,"for"],["type","number","min","0",1,"fs-6","form-control","form-control-sm",3,"id","formControlName"],["type","radio",1,"form-check-input","me-1",3,"id","formControlName","value"],[1,"form-check-label",3,"for"],["for","returnDate",1,"text-nowrap","m-1"],["type","date","id","returnDate","formControlName","returnDate",1,"form-control","fs-6"],["for","returnHour",1,"text-nowrap","m-1"],["id","returnHour","formControlName","returnHour",1,"form-select","form-select-sm","fs-6","w-auto"],["for","returnHour",1,"m-1"],["id","returnMinute","formControlName","returnMinute",1,"form-select","form-select-sm","fs-6","w-auto"],["for","returnMinute",1,"m-1"],["formControlName","returnSearchMethod",1,"form-select","form-select-sm","fs-6"],["for","returnApointTrainNumber",1,"text-center","m-1","text-nowrap"],["type","text","id","returnApointTrainNumber","formControlName","returnApointTrainNumber",1,"fs-6","form-control","form-control-sm","flex-grow-1"]],template:function(e,o){e&1&&(n(0,"form",0)(1,"div",1)(2,"div",2)(3,"label",3),a(4,"\u51FA\u767C\u7AD9"),t(),n(5,"div",4)(6,"select",5),I(7,An,2,2,"option",6,j),t()(),n(9,"div",7)(10,"a",8),_("click",function(){return o.swapStation()}),g(11,"i",9),t()(),n(12,"label",10),a(13,"\u5230\u9054\u7AD9"),t(),n(14,"div",4)(15,"select",11),I(16,Fn,2,2,"option",6,j),t()(),n(18,"div",7),g(19,"input",12),n(20,"label",13),a(21,"\u53BB\u56DE\u7968"),t()(),n(22,"div",14)(23,"span"),a(24,"\u7E3D\u4EBA\u6578 "),t(),n(25,"strong"),a(26),t()()(),n(27,"div",15)(28,"div",4),a(29,"\u8EAB\u5206\u5225/\u5F35\u6578"),t(),I(30,Nn,4,4,"div",16,wn),t(),n(32,"div",17)(33,"div",7),a(34,"\u8ECA\u5EC2\u7A2E\u985E"),t(),I(35,Bn,4,8,"div",7,Mn),t(),n(37,"app-member-code",18),_("personalIdChange",function(m){return o.personalId.set(m)})("coperateIdChange",function(m){return o.coperateId.set(m)}),t()(),n(38,"div",19),a(39,"\u53BB\u7A0B"),t(),n(40,"div",20)(41,"label",21),a(42,"\u51FA\u767C\u65E5\u671F"),t(),n(43,"div",22),g(44,"input",23),t(),n(45,"div",24)(46,"label",25),a(47,"\u51FA\u767C\u6642\u9593"),t(),n(48,"select",26),I(49,$n,2,2,"option",6,j),t(),n(51,"label",27),a(52,"\u6642"),t(),n(53,"select",28),I(54,Pn,2,2,"option",6,j),t(),n(56,"label",29),a(57,"\u5206"),t()(),n(58,"select",30)(59,"option",31),a(60,"\u4EE5\u51FA\u767C\u6642\u9593\u67E5\u8A62"),t(),n(61,"option",32),a(62,"\u4EE5\u5230\u9054\u6642\u9593\u67E5\u8A62"),t()(),n(63,"label",33),a(64,"\u6307\u5B9A\u8ECA\u6B21"),t(),g(65,"input",34),t(),h(66,jn,28,0),n(67,"div",35)(68,"div",36)(69,"div",37)(70,"div",38)(71,"label",39),a(72,"\u5C08\u6848\u5206\u985E"),t(),n(73,"select",40),I(74,Ln,2,2,"option",6,kn),t()(),n(76,"div",41)(77,"label",42),a(78,"\u4FC3\u92B7\u4EE3\u78BC"),t(),n(79,"select",43)(80,"option",44),a(81,"\u8ACB\u9078\u64C7"),t(),I(82,qn,2,2,"option",6,In),t()()(),n(84,"span",45),a(85,"\u6216"),t(),n(86,"div",46)(87,"label",47),a(88,"\u4FC3\u92B7\u4EE3\u78BC"),t(),g(89,"input",48),t()()(),n(90,"div",49)(91,"button",50),_("click",function(){return o.onSubmit(o.bookingType.general)}),a(92," \u4E00\u822C\u8A02\u4F4D "),t(),n(93,"button",51),_("click",function(){return o.onSubmit(o.bookingType.group)}),a(94," \u5718\u9AD4\u8A02\u4F4D "),t()()()),e&2&&(d("formGroup",o.form),s(7),A(o.departStationList()),s(9),A(o.arrivalStationList()),s(10),c(o.totalPeople()),s(4),A(o.profiles()),s(5),A(o.classTypes()),s(14),A(o.hours()),s(5),A(o.minutes()),s(12),E(o.roundTrip()?66:-1),s(8),A(o.promotionTypeList()),s(8),A(o.filteredPromotionDataList()),s(7),W("disabled",o.promotionList()),gt("readonly",o.promotionList()?"true":null),s(2),d("disabled",o.disableGernalBook()),s(2),d("disabled",o.disableGroupBook()))},dependencies:[V,q,xe,ve,Se,be,ze,Fe,he,Je,oe,ge,on,re,Be,$e,Ze,ye],encapsulation:2})};var Ft=Ot(Mt());var Rn=(r,i)=>i.index,Yn=(r,i)=>i.name;function Hn(r,i){if(r&1&&(n(0,"span",5),a(1),t()),r&2){let e=u();s(),c(e.promotionText())}}function Wn(r,i){if(r&1&&(n(0,"option",9),a(1),t()),r&2){let e=i.$implicit;d("value",e),s(),c(e)}}function Gn(r,i){if(r&1&&(n(0,"option",9),a(1),t()),r&2){let e=i.$implicit;d("value",e),s(),c(e)}}function Un(r,i){if(r&1&&(n(0,"span",26),a(1),t()),r&2){let e=i.$implicit;Wt("background-color","#"+e.colorCode),s(),P(" ",e==null?null:e.name," ")}}function Qn(r,i){if(r&1){let e=L();n(0,"tr",21),_("click",function(){let l=D(e).$implicit,m=u();return w(m.index.set(l.index))}),n(1,"td")(2,"input",22),_("change",function(){let l=D(e).$implicit,m=u();return w(m.index.set(l.index))}),t()(),n(3,"td"),a(4),t(),n(5,"td"),a(6),t(),n(7,"td"),a(8),t(),n(9,"td"),a(10),t(),n(11,"td"),a(12),t(),n(13,"td"),a(14),t(),n(15,"td",23)(16,"div",24),I(17,Un,2,3,"span",25,Yn),t()()()}if(r&2){let e=i.$implicit,o=u();s(2),d("name",o.prefix()+"shift-index")("value",e.index)("checked",o.index()===e.index),s(2),c(e.trainNumber),s(2),c(e.departTime),s(2),c(e.arrivalTime),s(2),c(e.elapseTime),s(2),c(e.aVLSeatCount),s(2),c(e.trainDiscount),s(3),A(e.projects)}}var ot=class r{search=te();query=O(null);records=O([]);outbound=O(!0);promotion=O(null);index=pe(0);hours=T(Array.from({length:24},(i,e)=>e.toString().padStart(2,"0")));minutes=T(Array.from({length:60},(i,e)=>e.toString().padStart(2,"0")));prefix=M(()=>this.outbound()?"outbound":"inbound");queryObj=M(()=>this.query()||{});fromStation=M(()=>this.queryObj()[this.outbound()?"departStation":"arrivalStation"]);toStation=M(()=>this.queryObj()[this.outbound()?"arrivalStation":"departStation"]);date=M(()=>new Date(this.queryObj()[this.outbound()?"departDate":"returnDate"]||0));time=M(()=>(this.queryObj()[this.outbound()?"departTime":"returnTime"]||"").split(":"));searchMethod=M(()=>this.queryObj()[this.outbound()?"departSearchMethod":"returnSearchMethod"]||1);hour=M(()=>this.time()[0]);minute=M(()=>this.time()[1]);promotionText=M(()=>{let i=this.promotion();if(!i)return"";let e=i.projectDiscount>0?`\u6298\u6263\u7387${i.projectDiscount}%`:`\u6298\u50F9${i.projectDiscount}`;return`${i.code} - ${i.projectName} ${e}`});form;formBuilder=y(Pe);constructor(){this.form=this.formBuilder.group({hour:[this.hour()],minute:[this.minute()],searchMethod:[this.searchMethod()]})}ngOnChanges(i){if(i.query&&this.form.patchValue({hour:this.hour(),minute:this.minute(),searchMethod:this.searchMethod()}),i.records){let e=this.records();e.length&&setTimeout(()=>{this.index.set(e[0].index)},0)}}onSubmit(){this.search.emit(this.form.value)}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=k({type:r,selectors:[["app-timetable"]],inputs:{query:[1,"query"],records:[1,"records"],outbound:[1,"outbound"],promotion:[1,"promotion"],index:[1,"index"]},outputs:{search:"search",index:"indexChange"},features:[Ae],decls:56,vars:17,consts:[[1,"d-flex","flex-column","h-100"],[1,"d-flex","align-items-center","mb-1","fw-bold","p-2"],[1,"me-1","text-danger"],[1,"me-1"],[1,"me-2"],[1,"fw-bold","text-danger","me-1"],[1,"d-flex","align-items-center","flex-wrap","gap-2","ms-auto",3,"ngSubmit","formGroup"],[3,"for"],["formControlName","hour",1,"form-select","form-select-sm","w-auto",3,"id"],[3,"value"],["formControlName","minute",1,"form-select","form-select-sm","w-auto",3,"id"],["formControlName","searchMethod",1,"form-select","form-select-sm","w-auto","me-1","fw-bold",3,"id"],["value","1"],["value","2"],[1,"btn","btn-sm","btn-primary","fw-bold"],[1,"flex-1","overflow-auto"],[1,"table","table-striped","table-hover","table-bordered","table-sticky-header","text-center","align-middle","m-0"],[1,"table-warning","backdrop-blur"],[1,"text-nowrap"],[1,"text-nowrap","w-25"],["role","button"],["role","button",3,"click"],["type","radio",1,"form-check-input","me-1",3,"change","name","value","checked"],[1,"w-25"],[1,"d-flex","flex-wrap","justify-content-start","w-100"],[1,"badge","me-1","mb-1",3,"backgroundColor"],[1,"badge","me-1","mb-1"]],template:function(e,o){e&1&&(n(0,"div",0)(1,"div",1)(2,"span",2),a(3),t(),n(4,"span",3),a(5),t(),n(6,"span",3),a(7,"\u2192"),t(),n(8,"span",4),a(9),t(),n(10,"span",4),a(11),Re(12,"date"),t(),h(13,Hn,2,1,"span",5),n(14,"form",6),_("ngSubmit",function(){return o.onSubmit()}),n(15,"label",7),a(16,"\u6642\u9593:"),t(),n(17,"select",8),I(18,Wn,2,2,"option",9,j),t(),n(20,"label",7),a(21,"\u6642"),t(),n(22,"select",10),I(23,Gn,2,2,"option",9,j),t(),n(25,"label",7),a(26,"\u5206"),t(),n(27,"select",11)(28,"option",12),a(29,"\u4EE5\u51FA\u767C\u6642\u9593\u67E5\u8A62"),t(),n(30,"option",13),a(31,"\u4EE5\u5230\u9054\u6642\u9593\u67E5\u8A62"),t()(),n(32,"button",14),a(33,"\u67E5\u8A62"),t()()(),n(34,"div",15)(35,"table",16)(36,"thead",17)(37,"tr"),g(38,"th"),n(39,"th",18),a(40,"\u8ECA\u6B21"),t(),n(41,"th",18),a(42,"\u51FA\u767C\u6642\u9593"),t(),n(43,"th",18),a(44,"\u5230\u9054\u6642\u9593"),t(),n(45,"th",18),a(46,"\u884C\u8ECA\u6642\u9593"),t(),n(47,"th",18),a(48,"\u53EF\u552E\u5EA7\u4F4D\u6578"),t(),n(49,"th",18),a(50,"\u512A\u60E0*"),t(),n(51,"th",19),a(52,"\u5C08\u6848*"),t()()(),n(53,"tbody"),I(54,Qn,19,9,"tr",20,Rn),t()()()()),e&2&&(s(3),c(o.outbound()?"\u53BB\u7A0B\u5217\u8ECA":"\u56DE\u7A0B\u5217\u8ECA"),s(2),c(o.fromStation()),s(4),c(o.toStation()),s(2),c(Qt(12,12,o.date(),"MM/dd (EEEEE)","","zh")),s(2),E(o.promotion()?13:-1),s(),d("formGroup",o.form),s(),d("for",o.prefix()+"hour"),s(2),d("id",o.prefix()+"hour"),s(),A(o.hours()),s(2),d("for",o.prefix()+"hour"),s(2),d("id",o.prefix()+"minute"),s(),A(o.minutes()),s(2),d("for",o.prefix()+"minute"),s(2),d("id",o.prefix()+"searchMethod"),s(27),A(o.records()))},dependencies:[V,Zt,q,xe,ve,Se,he,oe,ge,re,Be,$e],encapsulation:2})};var At={code:[],message:null,data:{tripType:2,isGroup:!1,trainInfo:{outbound:{discount:"Y",trainNumber:"0567",departStation:"\u677F\u6A4B",departDate:"11/08",departTime:"09:00",departDay:"FAR",arrivalStation:"\u53F0\u4E2D",arrivalDate:"11/08",arrivalTime:"11:00",arrivalDay:"FAR",elapseTime:"00:51",classType:"\u6A19\u6E96\u8ECA\u5EC2"},inbound:{discount:"Y",trainNumber:"0888",departStation:"\u53F0\u4E2D",departDate:"11/09",departTime:"17:00",departDay:"SAT",arrivalStation:"\u677F\u6A4B",arrivalDate:"11/09",arrivalTime:"19:00",arrivalDay:"SAT",elapseTime:"00:55",classType:"\u6A19\u6E96\u8ECA\u5EC2"}},membership:{personalId:"",coperateId:""},passengerInfo:[{index:"1",profile:"\u6210\u4EBA",outbound:{fare:"700",car:"05",seat:"3A"},inbound:{fare:"700",car:"02",seat:"4A"}},{index:"2",profile:"\u5B69\u7AE5",outbound:{fare:"700",car:"05",seat:"3B"},inbound:{fare:"700",car:"02",seat:"4B"}},{index:"3",profile:"\u611B\u5FC3",outbound:{fare:"700",car:"05",seat:"3C"},inbound:{fare:"700",car:"02",seat:"4C"}},{index:"4",profile:"\u656C\u8001",outbound:{fare:"700",car:"05",seat:"3D"},inbound:{fare:"700",car:"02",seat:"4D"}},{index:"5",profile:"\u7279\u60E0\u534A",outbound:{fare:"700",car:"05",seat:"3E"},inbound:{fare:"700",car:"02",seat:"4E"}},{index:"6",profile:"\u7279\u60E0\u5168",outbound:{fare:"700",car:"05",seat:"4A"},inbound:{fare:"700",car:"02",seat:"5A"}}],promotion:{code:"P001",projectName:"\u516C\u52D9\u4E58\u8ECA",projectDiscount:"-100"}}};function zn(r,i){if(r&1){let e=L();n(0,"div",3)(1,"app-timetable",7),de("indexChange",function(l){D(e);let m=u(2);return ie(m.inboundIndex,l)||(m.inboundIndex=l),w(l)}),_("search",function(l){D(e);let m=u(2);return w(m.onInboundSearch(l))}),t()()}if(r&2){let e=u(2);s(),d("records",e.inbound())("promotion",e.promotion())("query",e.query()),me("index",e.inboundIndex),d("outbound",!1)}}function Jn(r,i){if(r&1){let e=L();n(0,"div",0)(1,"div",1)(2,"app-timetable",2),de("indexChange",function(l){D(e);let m=u();return ie(m.outboundIndex,l)||(m.outboundIndex=l),w(l)}),_("search",function(l){D(e);let m=u();return w(m.onOutboundSearch(l))}),t()(),h(3,zn,2,5,"div",3),n(4,"div",4)(5,"button",5),_("click",function(){D(e);let l=u();return w(l.onConfirm())}),a(6,"\u958B\u59CB\u8A02\u4F4D"),t(),n(7,"button",5),_("click",function(){D(e);let l=u();return w(l.onShowAll())}),a(8),t(),n(9,"button",6),_("click",function(){D(e);let l=u();return w(l.back.emit(null))}),a(10,"\u91CD\u8A2D\u67E5\u8A62\u689D\u4EF6"),t()()()}if(r&2){let e=u();s(),W("flex-1",e.roundTrip()),s(),d("records",e.outbound())("promotion",e.promotion())("query",e.query()),me("index",e.outboundIndex),s(),E(e.roundTrip()?3:-1),s(5),P(" ",e.showAll()?"\u50C5\u986F\u793A\u53EF\u552E\u8ECA\u6B21":"\u986F\u793A\u6700\u8FD1\u6240\u6709\u8ECA\u6B21"," ")}}var rt=class r{confirm=te();back=te();query=pe(null);data=pe(null);inbound=M(()=>this.data()?.inbound||[]);outbound=M(()=>this.data()?.outbound||[]);promotion=M(()=>this.data()?.promotion);showAll=M(()=>this.query()?.allTrain===1);roundTrip=M(()=>this.query()?.tripType===2);outboundIndex=0;inboundIndex=0;loadingService=y(ae);destroyRef=y(ee);messageService=y(le);onOutboundSearch(i){this.query.update(e=>(e.departTime=`${i.hour}:${i.minute}`,e.departSearchMethod=i.searchMethod,_e({},e))),this.updateQuery()}onInboundSearch(i){this.query.update(e=>(e.returnTime=`${i.hour}:${i.minute}`,e.returnSearchMethod=i.searchMethod,_e({},e))),this.updateQuery()}onShowAll(){this.query.update(i=>(i.allTrain=i.allTrain===0?1:0,_e({},i))),this.updateQuery()}onConfirm(){if(this.loadingService.loading)return;let i={outboundTrainIndex:this.outboundIndex,inboundTrainIndex:this.inboundIndex};this.loadingService.start(),this.request(i).pipe(z(this.destroyRef)).subscribe({next:e=>{this.loadingService.stop();let{anyError:o}=this.messageService.processCodes(e.code);o||this.confirm.emit(e.data)},error:e=>{console.error(e),this.loadingService.stop()},complete:()=>{this.loadingService.stop()}})}validate(){let i=[],e=this.outbound().find(l=>l.index===this.outboundIndex),o=this.inbound().find(l=>l.index===this.inboundIndex);if(this.roundTrip()&&e.departDate===o.departDate){let l=(0,Ft.default)(`${e.arrivalDate} ${e.arrivalTime}`,"YYYY/MM/DD HH:mm"),m=(0,Ft.default)(`${o.departDate} ${o.departTime}`,"YYYY/MM/DD HH:mm");if(m.isBefore(l)||m.isSame(l)){let{departDate:N}=this.query(),B=N.split("/")[0];i.push(`\u56DE\u7A0B\u51FA\u767C\u6642\u9593\u5FC5\u9808\u665A\u65BC\u53BB\u7A0B\u5230\u9054\u6642\u9593\u3002\u53BB\u7A0B\u51FA\u767C(\u5230\u9054)\u6642\u9593${B}/${l.format("MM/DD HH:mm")} - \u56DE\u7A0B\u51FA\u767C\u6642\u9593${B}/${m.format("MM/DD HH:mm")}`)}}return i}request(i){return console.log(i),X(At).pipe(K(100))}updateQuery(){console.log(this.query()),this.loadingService.start(),X(At).pipe(K(100),z(this.destroyRef)).subscribe({next:()=>{this.loadingService.stop()},error:i=>{console.error(i),this.loadingService.stop()},complete:()=>{this.loadingService.stop()}})}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=k({type:r,selectors:[["app-step2"]],inputs:{query:[1,"query"],data:[1,"data"]},outputs:{confirm:"confirm",back:"back",query:"queryChange",data:"dataChange"},decls:1,vars:1,consts:[[1,"d-flex","flex-column","h-100","py-2"],[1,"border","rounded","shadow-sm","p-0","overflow-hidden"],[3,"indexChange","search","records","promotion","query","index"],[1,"flex-1","border","rounded","shadow-sm","p-0","overflow-hidden","mt-2"],[1,"d-flex","gap-3","justify-content-center","mt-2"],[1,"btn","btn-primary",3,"click"],[1,"btn","btn-dark",3,"click"],[3,"indexChange","search","records","promotion","query","index","outbound"]],template:function(e,o){e&1&&h(0,Jn,11,8,"div",0),e&2&&E(o.data()?0:-1)},dependencies:[q,V,ot],styles:["[_nghost-%COMP%]{display:block;height:100%}"]})};var Nt=[null,"E","D","C","B","A"],at=class r{transform([i,e,o,l]){let m=`${i}${Nt[e]}`,N=l.toString().padStart(2,"0");return o.find(B=>B.car===N&&B.seat===m)}static \u0275fac=function(e){return new(e||r)};static \u0275pipe=Ht({name:"seatPassenger",type:r,pure:!0})};var Zn=()=>[1,2],cn=(r,i,e,o)=>[r,i,e,o],Xn=()=>[3,4,5],Kn=(r,i)=>i.index;function ei(r,i){if(r&1&&(n(0,"div",34),a(1),t()),r&2){let e=i.$implicit;s(),P(" ",e," ")}}function ti(r,i){if(r&1){let e=L();ht(0),Re(1,"seatPassenger"),n(2,"a",39),_("click",function(){let l=D(e).$implicit,m=St(0),N=u().$implicit,B=u(3);return w(B.selectSeat(N,l,m))}),g(3,"i",16)(4,"i",25),a(5),t()}if(r&2){let e=i.$implicit,o=u().$implicit,l=u(3),m=vt(Tt(1,4,Et(7,cn,o[0],e,l.passengers(),l.carNumber())));s(2),W("selected",m),d("ngClass",l.seatStatus[o[e]].class),s(3),P(" ",m==null?null:m.index," ")}}function ni(r,i){if(r&1&&(n(0,"div",35)(1,"div",37),a(2),t(),I(3,ti,6,12,"a",38,j),t()),r&2){let e=i.$implicit;s(2),c(e[0]),s(),A(yt(1,Zn))}}function ii(r,i){if(r&1&&(n(0,"div",34),a(1),t()),r&2){let e=i.$implicit;s(),P(" ",e," ")}}function oi(r,i){if(r&1){let e=L();ht(0),Re(1,"seatPassenger"),n(2,"a",39),_("click",function(){let l=D(e).$implicit,m=St(0),N=u().$implicit,B=u(3);return w(B.selectSeat(N,l,m))}),g(3,"i",16)(4,"i",25),a(5),t()}if(r&2){let e=i.$implicit,o=u().$implicit,l=u(3),m=vt(Tt(1,4,Et(7,cn,o[0],e,l.passengers(),l.carNumber())));s(2),W("selected",m),d("ngClass",l.seatStatus[o[e]].class),s(3),P(" ",m==null?null:m.index," ")}}function ri(r,i){if(r&1&&(n(0,"div",35),I(1,oi,6,12,"a",38,j),n(3,"div",37),a(4),t()()),r&2){let e=i.$implicit;s(),A(yt(1,Xn)),s(3),c(e[0])}}function ai(r,i){if(r&1&&(n(0,"div",7)(1,"div",31)(2,"div",32),g(3,"div",33),I(4,ei,2,1,"div",34,j),t(),I(6,ni,5,2,"div",35,j),t(),n(8,"div",36),a(9," \u8D70\u9053 "),t(),n(10,"div",31)(11,"div",32),I(12,ii,2,1,"div",34,j),t(),I(14,ri,5,2,"div",35,j),t()()),r&2){let e=i;s(4),A(e.columnName.slice(0,2)),s(2),A(e.value),s(6),A(e.columnName.slice(2)),s(2),A(e.value)}}function li(r,i){if(r&1&&(n(0,"option",12),a(1),t()),r&2){let e=i.$implicit;d("value",e),s(),P(" ",e," ")}}function si(r,i){if(r&1&&(n(0,"div",9)(1,"span",40),a(2,"\u8ECA\u5EC2\u7A2E\u985E:"),t(),n(3,"span",41),a(4),t()(),n(5,"div",9)(6,"span",42),a(7,"\u5168\u8ECA\u5EA7\u4F4D\u6578:"),t(),n(8,"span"),a(9),t()(),n(10,"div",9)(11,"span",42),a(12,"\u672C\u8ECA\u5EC2\u5EA7\u4F4D:"),t(),n(13,"span"),a(14),t()()),r&2){let e=i;s(4),c(e.classType),s(5),c(e.regSeat),s(5),c(e.totalSeats)}}function mi(r,i){if(r&1&&(n(0,"tr")(1,"td",30),a(2),t(),n(3,"td",30),a(4),t(),n(5,"td",30),a(6),t()()),r&2){let e=i.$implicit;s(2),c(e.index),s(2),c(e.profile),s(2),qe("",e.car,"/",e.seat,"")}}function di(r,i){if(r&1){let e=L();n(0,"div",0)(1,"p",1),a(2,"\u5EA7\u4F4D\u8868"),t(),n(3,"button",2),_("click",function(){D(e);let l=u();return w(l.ngbActiveModal.close(null))}),t()(),n(4,"div",3)(5,"div",4)(6,"div",5)(7,"span",6),a(8," \u65E5\u671F: "),n(9,"span"),a(10),t()(),n(11,"span",6),a(12),t(),n(13,"span",6),a(14),t(),n(15,"span",6),a(16),t()(),h(17,ai,16,0,"div",7),t(),n(18,"div",8)(19,"div",9)(20,"span",10),a(21,"\u8ECA\u5EC2:"),t(),n(22,"select",11),_("ngModelChange",function(l){D(e);let m=u();return w(m.carNumber.set(l))}),I(23,li,2,2,"option",12,j),t()(),h(25,si,15,3),n(26,"ul",13)(27,"li",9)(28,"span",14),a(29,"\u4E00\u822C\u5EA7\u4F4D"),t(),n(30,"div",15),g(31,"i",16),t(),n(32,"div",17),a(33," N "),t()(),n(34,"li",9)(35,"span",14),a(36,"\u4FDD\u7559\u5EA7\u4F4D"),t(),n(37,"div",18),g(38,"i",16),t(),g(39,"div",19),t(),n(40,"li",9)(41,"span",14),a(42,"\u656C\u8001\u611B\u5FC3\u5EA7"),t(),n(43,"div",20),g(44,"i",16),t(),n(45,"div",21),a(46," N "),t()(),n(47,"li",9)(48,"span",14),a(49,"\u7121\u969C\u7919\u5EA7\u4F4D"),t(),n(50,"div",22),g(51,"i",16),t(),n(52,"div",23),a(53," N "),t()(),n(54,"li",9)(55,"span",14),a(56,"\u5DF2\u88AB\u5360\u7528\u5EA7"),t(),n(57,"div",24),g(58,"i",25),t(),g(59,"div",19),t()(),n(60,"button",26),_("click",function(){D(e);let l=u();return w(l.reset())}),a(61,"\u5EA7\u4F4D\u91CD\u8A2D"),t(),n(62,"button",27),_("click",function(){D(e);let l=u();return w(l.confirm())}),a(63,"\u5EA7\u4F4D\u78BA\u8A8D"),t(),n(64,"table",28)(65,"thead",29)(66,"tr")(67,"th",30),a(68,"\u7DE8\u865F"),t(),n(69,"th",30),a(70,"\u8EAB\u5206\u5225"),t(),n(71,"th",30),a(72,"\u8ECA\u5EC2/\u5EA7\u4F4D"),t()()(),n(73,"tbody"),I(74,mi,7,4,"tr",null,Kn),t()()()()}if(r&2){let e,o,l=i,m=u();s(10),P("",l.date," "),s(2),P("\u8ECA\u6B21: ",l.trainNumber,""),s(2),P("\u51FA\u767C\u7AD9: ",l.departStation,""),s(2),P("\u5230\u9054\u7AD9: ",l.arrivalStation,""),s(),E((e=m.seat())?17:-1,e),s(5),d("ngModel",m.carNumber()),s(),A(m.carNumbers()),s(2),E((o=m.seat())?25:-1,o),s(49),A(m.passengers())}}var fn={};[{symbol:"",class:"invisible"},{symbol:"V",class:"seat-reserved"},{symbol:"$",class:"seat-taken"},{symbol:"@",class:"seat-available"},{symbol:"@C",class:"seat-priority"},{symbol:"@W",class:"seat-accessibility"}].forEach(r=>{fn[r.symbol]=r});var lt=class r{seatStatus=fn;seatData=T(null);passengers=T([]);carNumber=T("");carNumbers=M(()=>this.seatData()?.seats.map(i=>i.carNumber)||[]);seat=M(()=>{let i=this.seatData()?.seats||[],e=this.carNumber();return i.find(l=>l.carNumber===e)});ngbActiveModal=y(Xe);ngOnInit(){this.setCarNumber()}ngOnChanges(){this.setCarNumber()}selectSeat(i,e,o){if(o){o.seat=null,o.car=null,this.passengers.set([...this.passengers()]);return}i[e]==="$"||i[e]==="V"||(o=this.passengers().find(l=>!l.car),o&&(o.seat=`${i[0]}${Nt[e]}`,o.car=this.carNumber().toString().padStart(2,"0"),this.passengers.set([...this.passengers()])))}reset(){this.passengers.update(i=>i.map(e=>Ue(_e({},e),{seat:null,car:null})))}confirm(){this.ngbActiveModal.close(this.passengers())}setCarNumber(){let i=!1,e=this.passengers()[0];e?.car&&(this.carNumber.set(parseInt(e.car,10).toString()),i=!0),i||this.carNumber.set(this.carNumbers()[0])}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=k({type:r,selectors:[["app-seat-modal"]],features:[Ae],decls:1,vars:1,consts:[[1,"modal-header","bg-warning-subtle","align-items-center","justify-content-between"],[1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body","d-flex","align-items-start"],[1,"flex-grow-1"],[1,"fs-6"],[1,"ms-3"],[1,"d-flex","justify-content-start","ms-5"],[1,"mx-4","fs-6","w-30"],[1,"d-flex","text-nowrap","align-items-center","m-2","justify-content-between"],[1,"me-2"],[1,"form-select","form-select-sm","fs-7","ml-2",3,"ngModelChange","ngModel"],[3,"value"],[1,"list-unstyled"],[1,"legend-box"],[1,"d-flex","align-items-center","justify-content-center","m-1","border","w-30-px","seat","ms-auto"],[1,"fas","fa-chair"],[1,"d-flex","align-items-center","justify-content-center","m-1","border","w-30-px","seat","seat-available","selected"],[1,"d-flex","align-items-center","justify-content-center","m-1","border","w-30-px","seat","seat-reserved","ms-auto"],[1,"m-1","w-30-px"],[1,"d-flex","align-items-center","justify-content-center","m-1","border","w-30-px","seat","seat-priority","ms-auto"],[1,"d-flex","align-items-center","justify-content-center","m-1","border","w-30-px","seat","seat-priority","selected"],[1,"d-flex","align-items-center","justify-content-center","m-1","border","w-30-px","seat","seat-accessibility","ms-auto"],[1,"d-flex","align-items-center","justify-content-center","m-1","border","w-30-px","seat","seat-accessibility","selected"],[1,"d-flex","align-items-center","justify-content-center","m-1","border","w-30-px","seat","seat-taken","ms-auto"],[1,"fas","fa-ban"],[1,"btn","btn-secondary","btn-sm","me-1",3,"click"],[1,"btn","btn-primary","btn-sm",3,"click"],[1,"table","mt-3","table-bordered","text-center","align-middle"],[1,"table-light"],[1,"text-nowrap"],[1,"mt-3"],[1,"d-flex","gap-3","mb-1"],[1,"text-center","fw-bold","w-30-px"],[1,"text-center","fw-bold","bg-warning-subtle","w-30-px"],[1,"d-flex","align-items-center","gap-3","mb-1"],[1,"w-5","container","my-3","mx-3","d-flex","align-items-center","justify-content-center","flex-column","bg-warning-subtle"],[1,"text-center","bg-warning-subtle","w-30-px"],["href","javascript:;",1,"d-flex","align-items-center","justify-content-center","border","w-30-px","seat","text-decoration-none",3,"ngClass","selected"],["href","javascript:;",1,"d-flex","align-items-center","justify-content-center","border","w-30-px","seat","text-decoration-none",3,"click","ngClass"],[1,"me-1","text-end"],[1,"text-start"],[1,"me-1"]],template:function(e,o){if(e&1&&h(0,di,76,7),e&2){let l;E((l=o.seatData())?0:-1,l)}},dependencies:[V,zt,q,ve,Se,he,oe,Ne,at],styles:[".seat[_ngcontent-%COMP%]{height:30px;border-radius:4px}.seat[_ngcontent-%COMP%]   .fa-ban[_ngcontent-%COMP%], .seat.selected[_ngcontent-%COMP%]   .fas[_ngcontent-%COMP%]{display:none}.seat-reserved[_ngcontent-%COMP%]{color:#0dcaf0}.seat-priority[_ngcontent-%COMP%]{color:#ffc107}.seat-priority.selected[_ngcontent-%COMP%]{background-color:#ffc107;color:#000}.seat-accessibility[_ngcontent-%COMP%]{color:#0d6efd}.seat-accessibility.selected[_ngcontent-%COMP%]{background-color:#0d6efd;color:#000}.seat-available[_ngcontent-%COMP%]{color:#000}.seat-available.selected[_ngcontent-%COMP%]{background-color:#d63384}.seat-taken[_ngcontent-%COMP%]{color:#000}.seat-taken[_ngcontent-%COMP%]   .fa-ban[_ngcontent-%COMP%]{display:inline}.seat-taken[_ngcontent-%COMP%]   .fa-chair[_ngcontent-%COMP%]{display:none}"]})};var Cn={code:null,message:null,data:{date:"12/08",trainNumber:"0129",departStation:"TPE",arrivalStation:"TAC",seats:[{carNumber:"5",classType:"\u6A19\u6E96\u8ECA\u5EC2",regSeat:"574",totalSeats:"63",columnName:["E","D","C","B","A"],value:[["1","","","","",""],["2","@","@","$","$","$"],["3","@","@","@","@","@"],["4","@","@","@","@","@"],["5","@","@","@","@","@"],["6","@","@","@","@","@"],["7","@","@","@","@","@"],["8","@","@","@","@","@"],["9","@","@","@","@","@"],["10","@","@","@","@","@"],["11","@","@","@","@","@"],["12","V","V","V","V","V"],["13","@C","@C","@C","@C","@C"],["14","@W","","","","@W"]]},{carNumber:"2",classType:"\u6A19\u6E96\u8ECA\u5EC2",regSeat:"574",totalSeats:"55",columnName:["E","D","C","B","A"],value:[["1","@","@","","",""],["2","@","@","$","$","$"],["3","@","@","@","@","@"],["4","@","@","@","@","@"],["5","@","@","@","@","@"],["13","@C","@C","@C","@C","@C"],["14","@W","","","","@W"]]}]}};function pi(r,i){r&1&&(n(0,"th",2),a(1,"\u5EA7\u4F4D\u9078\u64C7"),t())}function ui(r,i){if(r&1){let e=L();n(0,"td")(1,"button",3),_("click",function(){D(e);let l=u(2);return w(l.selectSeat(!0))}),a(2,"\u5EA7\u4F4D\u8868"),t()()}}function ci(r,i){if(r&1&&(n(0,"tr")(1,"td"),a(2,"\u53BB\u7A0B\u5217\u8ECA"),t(),n(3,"td"),a(4),t(),n(5,"td"),a(6),t(),n(7,"td"),a(8),t(),n(9,"td"),a(10),t(),n(11,"td"),a(12),t(),n(13,"td"),a(14),t(),n(15,"td"),a(16),t(),n(17,"td"),a(18),t(),n(19,"td"),a(20),t(),h(21,ui,3,0,"td"),t()),r&2){let e=i,o=u();s(4),c(e.discount),s(2),c(e.trainNumber),s(2),c(e.departStation),s(2),c(e.arrivalStation),s(2),c(e.departDate),s(2),c(e.departTime),s(2),c(e.arrivalTime),s(2),c(e.elapseTime),s(2),c(e.classType),s(),E(o.seatSelectable()?21:-1)}}function fi(r,i){if(r&1){let e=L();n(0,"td")(1,"button",3),_("click",function(){D(e);let l=u(3);return w(l.selectSeat(!1))}),a(2,"\u5EA7\u4F4D\u8868"),t()()}}function Ci(r,i){if(r&1&&(n(0,"tr")(1,"td"),a(2,"\u56DE\u7A0B\u5217\u8ECA"),t(),n(3,"td"),a(4),t(),n(5,"td"),a(6),t(),n(7,"td"),a(8),t(),n(9,"td"),a(10),t(),n(11,"td"),a(12),t(),n(13,"td"),a(14),t(),n(15,"td"),a(16),t(),n(17,"td"),a(18),t(),n(19,"td"),a(20),t(),h(21,fi,3,0,"td"),t()),r&2){let e=i,o=u(2);s(4),c(e.discount),s(2),c(e.trainNumber),s(2),c(e.departStation),s(2),c(e.arrivalStation),s(2),c(e.departDate),s(2),c(e.departTime),s(2),c(e.arrivalTime),s(2),c(e.elapseTime),s(2),c(e.classType),s(),E(o.seatSelectable()?21:-1)}}function _i(r,i){if(r&1&&h(0,Ci,22,10,"tr"),r&2){let e,o=u();E((e=o.inbound())?0:-1,e)}}var Ve=class r{outbound=O();inbound=O();seatSelectable=O(!0);roundTrip=O(!1);passengers=O();ngbModal=y(Ke);loadingService=y(ae);destroyRef=y(ee);data;selectSeat(i){this.loadingService.loading||(this.loadingService.start(),this.request({}).pipe(z(this.destroyRef)).subscribe({next:e=>{this.loadingService.stop(),this.data=e.data,this.openSeatModal(i)},error:e=>{console.error(e),this.loadingService.stop()},complete:()=>{this.loadingService.stop()}}))}openSeatModal(i){let e=this.ngbModal.open(lt,{size:"lg",centered:!0,scrollable:!0,backdrop:"static"});e.componentInstance.seatData.set(this.data);let o=(this.passengers()||[]).map(l=>{let m=i?l.outbound:l.inbound;return{index:l.index,profile:l.profile,car:m.car,seat:m.seat}});e.componentInstance.passengers.set(o)}request(i){return console.log(i),X(Cn).pipe(K(100))}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=k({type:r,selectors:[["app-bound"]],inputs:{outbound:[1,"outbound"],inbound:[1,"inbound"],seatSelectable:[1,"seatSelectable"],roundTrip:[1,"roundTrip"],passengers:[1,"passengers"]},decls:26,vars:3,consts:[[1,"table","table-striped","table-hover","table-bordered","table-sticky-header","text-center","align-middle","m-0"],[1,"table-warning","backdrop-blur"],[1,"text-nowrap"],[1,"btn","btn-primary",3,"click"]],template:function(e,o){if(e&1&&(n(0,"table",0)(1,"thead",1)(2,"tr"),g(3,"th",2),n(4,"th",2),a(5,"\u512A\u60E0*"),t(),n(6,"th",2),a(7,"\u8ECA\u6B21"),t(),n(8,"th",2),a(9,"\u51FA\u767C\u7AD9"),t(),n(10,"th",2),a(11,"\u5230\u9054\u7AD9"),t(),n(12,"th",2),a(13,"\u51FA\u767C\u65E5\u671F"),t(),n(14,"th",2),a(15,"\u51FA\u767C\u6642\u9593"),t(),n(16,"th",2),a(17,"\u5230\u9054\u6642\u9593"),t(),n(18,"th",2),a(19,"\u884C\u8ECA\u6642\u9593"),t(),n(20,"th",2),a(21,"\u5EC2\u7B49"),t(),h(22,pi,2,0,"th",2),t()(),n(23,"tbody"),h(24,ci,22,10,"tr")(25,_i,1,1),t()()),e&2){let l;s(22),E(o.seatSelectable()?22:-1),s(2),E((l=o.outbound())?24:-1,l),s(),E(o.roundTrip()?25:-1)}},dependencies:[q,V,re],encapsulation:2})};var bi=(r,i)=>i.index;function gi(r,i){if(r&1&&a(0),r&2){let e=u().$implicit;P(" ",e.personalId," ")}}function xi(r,i){r&1&&(n(0,"span",8),a(1,"*"),t())}function hi(r,i){if(r&1){let e=L();n(0,"input",19),_("change",function(){D(e);let l=u().$index,m=u();return w(m.onPersonalIdChange(l))}),t(),h(1,xi,2,0,"span",8),g(2,"input",20)}if(r&2){let e=u().$implicit;d("id","personalIdCheck-"+e.index),s(),E(e.profile==="\u611B\u5FC3"||e.profile==="\u656C\u8001"?1:-1),s(),d("id","personalId-"+e.index)}}function vi(r,i){if(r&1&&a(0),r&2){let e=u().$implicit;P(" ",e.expiryDate," ")}}function Si(r,i){r&1&&(n(0,"span",8),a(1,"*"),t())}function yi(r,i){if(r&1&&(h(0,Si,2,0,"span",8),g(1,"input",21)),r&2){let e=u().$implicit;E(e.expiryDateRequired?0:-1),s(),d("id","expiryDate-"+e.index)}}function Ei(r,i){r&1&&(n(0,"span",8),a(1,"*"),t())}function Ti(r,i){if(r&1&&(n(0,"label",15),a(1,"\u53BB:"),t()),r&2){let e=u().$implicit;d("for","outboundCoupon-"+e.index)}}function Di(r,i){if(r&1&&a(0),r&2){let e=u().$implicit;P(" ",e.outbound.coupon," ")}}function wi(r,i){r&1&&(n(0,"span",8),a(1,"*"),t())}function Mi(r,i){if(r&1&&(h(0,wi,2,0,"span",8),g(1,"input",22)),r&2){let e=u().$implicit;E(e.outboundCouponRequired?0:-1),s(),d("id","outboundCoupon-"+e.index)}}function ki(r,i){if(r&1&&a(0),r&2){let e=u(2).$implicit;P(" ",e.inbound.coupon," ")}}function Ii(r,i){r&1&&(n(0,"span",8),a(1,"*"),t())}function Ai(r,i){if(r&1&&(h(0,Ii,2,0,"span",8),g(1,"input",23)),r&2){let e=u(2).$implicit;E(e.inboundCouponRequired?0:-1),s(),d("id","inboundCoupon-"+e.index)}}function Fi(r,i){if(r&1&&(n(0,"div",16)(1,"label",15),a(2,"\u56DE:"),t(),h(3,ki,1,1)(4,Ai,2,2),t()),r&2){let e=u().$implicit,o=u();s(),d("for","inboundCoupon-"+e.index),s(2),E(o.readonly()?3:4)}}function Ni(r,i){if(r&1&&(n(0,"span",18)(1,"span"),a(2,"NT$"),t(),a(3),t()),r&2){let e=u().$implicit;s(3),c(e.inbound.fare)}}function Bi(r,i){if(r&1&&(n(0,"span",18),a(1),t()),r&2){let e=u().$implicit;s(),qe("",e.inbound.car,"/",e.inbound.seat,"")}}function $i(r,i){if(r&1){let e=L();n(0,"tr",5)(1,"td"),a(2),t(),n(3,"td"),a(4),t(),n(5,"td")(6,"div",6),h(7,gi,1,1)(8,hi,3,3),t()(),n(9,"td")(10,"div",6),h(11,vi,1,1)(12,yi,2,2),t()(),n(13,"td",7),h(14,Ei,2,0,"span",8),g(15,"input",9),n(16,"label",10),a(17,"\u6709"),t(),g(18,"input",11),n(19,"label",12),a(20,"\u7121"),t()(),n(21,"td",7)(22,"div",6)(23,"input",13),_("change",function(){let l=D(e).$index,m=u();return w(m.onNoIdDocumentChange(l))}),t(),n(24,"label",10),a(25,"\u7121\u8B49\u4EF6"),t()()(),n(26,"td")(27,"div",14)(28,"div",6),h(29,Ti,2,1,"label",15)(30,Di,1,1)(31,Mi,2,2),t(),h(32,Fi,5,2,"div",16),t()(),n(33,"td")(34,"div",14)(35,"span",17)(36,"span"),a(37,"NT$"),t(),a(38),t(),h(39,Ni,4,1,"span",18),t()(),n(40,"td")(41,"div",14)(42,"span",17),a(43),t(),h(44,Bi,2,2,"span",18),t()()()}if(r&2){let e=i.$implicit,o=i.$index,l=u();d("formGroupName",o),s(2),P(" ",e.index," "),s(2),c(e.profile),s(3),E(l.readonly()?7:8),s(4),E(l.readonly()?11:12),s(3),E(!l.readonly()&&e.needCompanionRequired?14:-1),s(),W("disabled",l.readonly()),d("id","needCompanionYes-"+e.index)("readonly",l.readonly()?"true":null),s(),d("for","needCompanionYes-"+e.index),s(2),W("disabled",l.readonly()),d("id","needCompanionNo-"+e.index)("readonly",l.readonly()?"true":null),s(),d("for","needCompanionNo-"+e.index),s(4),W("disabled",l.readonly()),d("id","noIdDocument-"+e.index)("readonly",l.readonly()?"true":null),s(),d("for","noIdDocument-"+e.index),s(5),E(l.roundTrip()?29:-1),s(),E(l.readonly()?30:31),s(2),E(l.roundTrip()?32:-1),s(6),c(e.outbound.fare),s(),E(l.roundTrip()?39:-1),s(4),qe("",e.outbound.car,"/",e.outbound.seat,""),s(),E(l.roundTrip()?44:-1)}}var Ee=class r{passengers=O();roundTrip=O(!1);readonly=O(!1);promotion=O(null);needToCheck=pe(!1);form;formBuilder=y(Pe);destroyRef=y(ee);constructor(){this.form=this.formBuilder.group({passengers:this.formBuilder.array([])}),this.form.valueChanges.pipe(z(this.destroyRef)).subscribe(()=>{let e=(this.form.get("passengers")?.value||[]).some(o=>(o.profile==="\u611B\u5FC3"||o.profile==="\u656C\u8001")&&!o.noIdDocument);this.needToCheck.set(e)})}ngOnChanges(i){if(i.passengers||"promotion"in i){let e=i.promotion?.currentValue,o=i.passengers.currentValue.map(l=>{l.personalIdRequired=l.profile==="\u611B\u5FC3"||l.profile==="\u656C\u8001",l.expiryDateRequired=l.profile==="\u611B\u5FC3",l.needCompanionRequired=l.profile==="\u611B\u5FC3";let m=l.profile==="\u7279\u60E0\u5168"||l.profile==="\u7279\u60E0\u534A"||e?.voucherNumberRequired;return l.outboundCouponRequired=m,l.inboundCouponRequired=m,this.formBuilder.group({index:[l.index],profile:[l.profile],personalIdCheck:[!1],personalId:[l.personalId||"",l.personalIdRequired?[Q.required]:[]],expiryDate:[l.expiryDate||"",l.expiryDateRequired?[Q.required]:[]],needCompanion:[l.needCompanion,l.needCompanionRequired?[Q.required]:[]],noIdDocument:[l.noIdDocument||!1],outboundCoupon:[l.outbound.coupon||"",l.outboundCouponRequired?[Q.required]:[]],inboundCoupon:[l.inbound.coupon||"",l.inboundCouponRequired?[Q.required]:[]]})});this.form.setControl("passengers",this.formBuilder.array(o))}}onPersonalIdChange(i){let e=this.form.get(`passengers.${i}`),o=e.get("profile")?.value,l=e.get("personalIdCheck")?.value;if((o==="\u611B\u5FC3"||o==="\u656C\u8001")&&l){let m=this.form.get("passengers"),N="";for(let B=i-1;B>=0;B--){let ce=m.get(B.toString());(ce?.get("profile")?.value==="\u611B\u5FC3"||ce?.get("profile")?.value==="\u656C\u8001")&&(N=ce?.get("personalId")?.value)}N&&e.get("personalId")?.setValue(N)}}onNoIdDocumentChange(i){let e=this.form.get(`passengers.${i}`);e.get("profile")?.value==="\u611B\u5FC3"&&(e.get("noIdDocument").value?(e.get("needCompanion")?.disable(),e.get("expiryDate")?.disable()):(e.get("needCompanion")?.enable(),e.get("expiryDate")?.enable()))}getValues(){return this.form.value.passengers.map(e=>({index:e.index,profile:e.profile,personalId:e.personalId,expiryDate:e.expiryDate,needCompanion:e.needCompanion,noIdDocument:e.noIdDocument,outbound:{coupon:e.outboundCoupon},inbound:{coupon:e.inboundCoupon}}))}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=k({type:r,selectors:[["app-passengers"]],inputs:{passengers:[1,"passengers"],roundTrip:[1,"roundTrip"],readonly:[1,"readonly"],promotion:[1,"promotion"],needToCheck:[1,"needToCheck"]},outputs:{needToCheck:"needToCheckChange"},features:[Ae],decls:25,vars:1,consts:[[3,"formGroup"],[1,"table","table-striped","table-hover","table-bordered","table-sticky-header","text-center","align-middle","m-0"],[1,"table-warning","backdrop-blur"],[1,"text-nowrap"],["formArrayName","passengers"],[3,"formGroupName"],[1,"d-flex","align-items-center"],[1,"align-items-center","text-nowrap"],[1,"m-1","text-danger"],["type","radio","formControlName","needCompanion","value","1",1,"form-check-input","me-1",3,"id","readonly"],[1,"form-check-label","me-2",3,"for"],["type","radio","formControlName","needCompanion","value","0",1,"form-check-input","me-1",3,"id","readonly"],[1,"form-check-label",3,"for"],["type","checkbox","formControlName","noIdDocument",1,"form-check-input","me-1","fs-6",3,"change","id","readonly"],[1,"d-flex","flex-column","justify-content-start"],[1,"me-1",3,"for"],[1,"d-flex","align-items-center","mt-1"],[1,"me-1","mb-2"],[1,"me-1","mb-1"],["type","checkbox","formControlName","personalIdCheck",1,"form-check-input","me-1","fs-6","flex-grow-1",3,"change","id"],["type","text","formControlName","personalId",1,"fs-6","form-control","form-control-sm","flex-grow-1",3,"id"],["type","date","formControlName","expiryDate",1,"fs-6","form-control","form-control-sm","flex-grow-1",3,"id"],["type","text","formControlName","outboundCoupon",1,"fs-6","form-control","form-control-sm","flex-grow-1",3,"id"],["type","text","formControlName","inboundCoupon",1,"fs-6","form-control","form-control-sm","flex-grow-1",3,"id"]],template:function(e,o){e&1&&(n(0,"form",0)(1,"table",1)(2,"thead",2)(3,"tr")(4,"th",3),a(5,"\u7DE8\u865F"),t(),n(6,"th",3),a(7,"\u8EAB\u5206\u5225"),t(),n(8,"th",3),a(9,"\u8EAB\u5206\u8B49\u865F / \u8B77\u7167\u865F\u78BC"),t(),n(10,"th",3),a(11,"\u6548\u671F"),t(),n(12,"th",3),a(13,"\u966A\u4F34\u8CC7\u683C"),t(),n(14,"th",3),a(15,"\u7121\u8B49\u4EF6"),t(),n(16,"th",3),a(17,"\u514C\u63DB\u5238\u865F\u78BC"),t(),n(18,"th",3),a(19,"\u7968\u50F9"),t(),n(20,"th",3),a(21,"\u8ECA\u5EC2/\u5EA7\u4F4D"),t()()(),n(22,"tbody",4),I(23,$i,45,29,"tr",5,bi),t()()()),e&2&&(d("formGroup",o.form),s(23),A(o.passengers()))},dependencies:[q,xe,be,Fe,Je,oe,ge,V,re,Be,$e,nn,Ze],encapsulation:2})};var _n={code:null,message:null,data:{pnrId:"02408026",tripType:2,isGroup:!1,trainInfo:{outbound:{discount:"Y",trainNumber:"0567",departStation:"\u677F\u6A4B",departDate:"11/08",departTime:"09:00",departDay:"FAR",arrivalStation:"\u53F0\u4E2D",arrivalDate:"11/08",arrivalTime:"11:00",arrivalDay:"FAR",elapseTime:"00:51",classType:"\u6A19\u6E96\u8ECA\u5EC2"},inbound:{discount:"Y",trainNumber:"0888",departStation:"\u53F0\u4E2D",departDate:"11/09",departTime:"17:00",departDay:"SAT",arrivalStation:"\u677F\u6A4B",arrivalDate:"11/09",arrivalTime:"19:00",arrivalDay:"SAT",elapseTime:"00:55",classType:"\u6A19\u6E96\u8ECA\u5EC2"}},membership:{personalId:"",coperateId:""},groupInfo:{groupName:"",personId:"",firstName:"",lastName:"",phoneNumber:""},passengerInfo:[{index:"1",profile:"\u6210\u4EBA",personalId:"A123456789",expiryDate:"",needCompanion:null,noIdDocument:!1,outbound:{coupon:"",fare:"700",car:"05",seat:"2E",mark:""},inbound:{coupon:"",ticketNumber:"",fare:"700",car:"02",seat:"1A",eCoupon:"CROXHC2E1E",mark:""}},{index:"2",profile:"\u656C\u8001",personalId:"A123456789",expiryDate:"",needCompanion:null,noIdDocument:!1,outbound:{coupon:"",fare:"700",car:"05",seat:"2E",mark:""},inbound:{coupon:"",ticketNumber:"",fare:"700",car:"02",seat:"1A",eCoupon:"CROXHC2E1E",mark:""}},{index:"3",profile:"\u656C\u8001",personalId:"A123456789",expiryDate:"2025/01/01",needCompanion:null,noIdDocument:!0,outbound:{coupon:"11111111",fare:"700",car:"05",seat:"2E",mark:""},inbound:{coupon:"22222222",ticketNumber:"",fare:"700",car:"02",seat:"1A",eCoupon:"CROXHC2E1E",mark:""}}],profile:[{code:"F",quantity:2},{code:"W",quantity:1}],totalFare:"1,400",promotion:{code:"P001",projectName:"\u516C\u52D9\u4E58\u8ECA",projectDiscount:"-100"}}};function Pi(r,i){if(r&1){let e=L();n(0,"div",1),g(1,"app-bound",2),n(2,"app-member-code",3),de("personalIdChange",function(l){let m=D(e);return ie(m.membership.personalId,l)||(m.membership.personalId=l),w(l)})("coperateIdChange",function(l){let m=D(e);return ie(m.membership.coperateId,l)||(m.membership.coperateId=l),w(l)}),t(),n(3,"div",4)(4,"app-passengers",5,0),_("needToCheckChange",function(l){D(e);let m=u();return w(m.needToCheck.set(l))}),t()(),n(6,"div",6)(7,"div"),a(8,"\u4FC3\u92B7\u4EE3\u78BC"),t(),n(9,"div"),a(10),t(),n(11,"div",7),g(12,"input",8),n(13,"label",9),a(14,"\u4FDD\u7559\u7968\u6839\u4F5C\u70BA\u4F9D\u64DA"),t()()(),n(15,"div",10)(16,"button",11),_("click",function(){D(e);let l=u();return w(l.onSubmit())}),a(17,"\u78BA\u8A8D"),t(),n(18,"button",12),_("click",function(){D(e);let l=u();return w(l.onCheck())}),a(19," \u8CC7\u683C\u6AA2\u6838 "),t(),n(20,"button",13),_("click",function(){D(e);let l=u();return w(l.back.emit(null))}),a(21,"\u91CD\u65B0\u9078\u64C7\u8ECA\u6B21"),t()()()}if(r&2){let e=i,o=u();s(),d("roundTrip",o.roundTrip())("outbound",e.trainInfo.outbound)("inbound",e.trainInfo.inbound)("passengers",e.passengerInfo),s(),me("personalId",e.membership.personalId)("coperateId",e.membership.coperateId),s(2),d("roundTrip",o.roundTrip())("passengers",e.passengerInfo)("promotion",o.selectedPromotion()),s(6),c(e.promotion.code),s(8),d("disabled",!o.needToCheck())}}var st=class r{confirm=te();back=te();data=O(null);promotions=O([]);roundTrip=M(()=>this.data()?.tripType===2);needToCheck=T(!1);selectedPromotion=M(()=>this.promotions().find(i=>i.promotionCode===this.data()?.promotion?.code)||null);loadingService=y(ae);destroyRef=y(ee);passengersComponent=Rt(Ee);onCheck(){console.log("onCheck")}onSubmit(){if(this.loadingService.loading)return;let i=this.passengersComponent().getValues(),o={membership:this.data().membership,passengerInfo:i};this.loadingService.start(),this.request(o).pipe(z(this.destroyRef)).subscribe({next:l=>{this.loadingService.stop(),this.confirm.emit(l.data)},error:l=>{console.error(l),this.loadingService.stop()},complete:()=>{this.loadingService.stop()}})}request(i){return console.log(i),X(_n).pipe(K(100))}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=k({type:r,selectors:[["app-step3"]],viewQuery:function(e,o){e&1&&Gt(o.passengersComponent,Ee,5),e&2&&Ut()},inputs:{data:[1,"data"],promotions:[1,"promotions"]},outputs:{confirm:"confirm",back:"back"},decls:1,vars:1,consts:[["passengers",""],[1,"d-flex","flex-column","h-100","py-2"],[3,"roundTrip","outbound","inbound","passengers"],[1,"mt-2",3,"personalIdChange","coperateIdChange","personalId","coperateId"],[1,"mt-2","overflow-auto"],[3,"needToCheckChange","roundTrip","passengers","promotion"],[1,"d-flex","gap-3","justify-content-start","mt-2"],[1,"ms-auto"],["type","checkbox","id","retain",1,"form-check-input","me-1","fs-6"],["for","retain"],[1,"d-flex","gap-3","justify-content-center","mt-2"],["type","button",1,"btn","btn-primary",3,"click"],["type","button",1,"btn","btn-dark","ms-auto",3,"click","disabled"],["type","button",1,"btn","btn-dark",3,"click"]],template:function(e,o){if(e&1&&h(0,Pi,22,11,"div",1),e&2){let l;E((l=o.data())?0:-1,l)}},dependencies:[q,V,Ve,re,Ee,ye],encapsulation:2})};var bn={code:null,message:null,data:{paymentType:["\u8ACB\u9078\u64C7","\u73FE\u91D1","\u4FE1\u7528\u5361","\u9280\u806F\u5361"],price:999,lastOtherMarkList:["\u8ACB\u9078\u64C7","\u8B8A\u66F4\u4E59\u6B21","\u4E0D\u5F97\u8B8A\u66F4\u9000\u7968"],lastPaymentOtherPaymentEnable:!1}};function Vi(r,i){if(r&1&&(n(0,"span"),a(1),t()),r&2){let e=i.$implicit;s(),c(e)}}function Oi(r,i){if(r&1){let e=L();n(0,"div",0),g(1,"app-bound",1)(2,"app-member-code",2),n(3,"div",3),g(4,"app-passengers",4),t(),n(5,"div",5)(6,"div",6)(7,"div",7),a(8,"\u7E3D\u4EBA\u6578"),t(),n(9,"div",8),a(10),I(11,Vi,2,1,"span",null,j),a(13," ) "),t()(),n(14,"div",6)(15,"div",7),a(16,"\u7E3D\u7968\u50F9"),t(),n(17,"div",9),a(18),t()()(),n(19,"div",10)(20,"div"),a(21,"\u4FC3\u92B7\u4EE3\u78BC"),t()(),n(22,"div",11)(23,"button",12),_("click",function(){D(e);let l=u();return w(l.onSubmit())}),a(24,"\u4ED8\u6B3E\u53D6\u7968"),t(),n(25,"button",13),_("click",function(){D(e);let l=u();return w(l.onCancel())}),a(26,"\u53D6\u6D88"),t()()()}if(r&2){let e=i,o=u();s(),d("roundTrip",o.roundTrip())("outbound",e.trainInfo.outbound)("inbound",e.trainInfo.inbound)("seatSelectable",!1),s(),d("personalId",e.membership.personalId)("coperateId",e.membership.coperateId)("disabled",!0),s(2),d("roundTrip",o.roundTrip())("passengers",e.passengerInfo)("readonly",!0),s(6),P(" ",o.totalPeople(),"\u4EBA ( "),s(),A(o.passengerProfiles()),s(7),c(e.totalFare)}}var mt=class r{confirm=te();cancel=te();data=O(null);roundTrip=M(()=>this.data()?.tripType===2);totalPeople=M(()=>this.data()?.passengerInfo.length||0);passengerProfiles=M(()=>{let i=this.data();if(!i)return[];let e={};for(let o of i.passengerInfo)e[o.profile]=(e[o.profile]||0)+1;return Object.entries(e).map(([o,l])=>`${o} ${l}\u5F35`)});messageService=y(le);loadingService=y(ae);destroyRef=y(ee);onSubmit(){this.loadingService.loading||(this.loadingService.start(),this.request({}).pipe(z(this.destroyRef)).subscribe({next:i=>{this.loadingService.stop(),this.confirm.emit(i.data)},error:i=>{console.error(i),this.loadingService.stop()},complete:()=>{this.loadingService.stop()}}))}onCancel(){return jt(this,null,function*(){(yield this.messageService.show({title:"\u53D6\u6D88\u8A02\u7968",message:"\u78BA\u5B9A\u53D6\u6D88\u8A02\u7968\u7D00\u9304\uFF1F",confirmation:!0,cancelText:"\u5426",confirmText:"\u662F"}).result)&&this.cancel.emit()})}request(i){return console.log(i),X(bn).pipe(K(100))}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=k({type:r,selectors:[["app-step4"]],inputs:{data:[1,"data"]},outputs:{confirm:"confirm",cancel:"cancel"},decls:1,vars:1,consts:[[1,"d-flex","flex-column","h-100","py-2"],[3,"roundTrip","outbound","inbound","seatSelectable"],[1,"mt-2",3,"personalId","coperateId","disabled"],[1,"mt-2","overflow-auto"],[3,"roundTrip","passengers","readonly"],[1,"bg-warning-subtle","mt-2","p-2","w-50"],[1,"d-flex"],[1,"me-5"],[1,"d-flex","gap-2"],[1,"ms-auto"],[1,"d-flex","gap-3","justify-content-start","mt-2"],[1,"d-flex","gap-3","justify-content-center","mt-2"],["type","button",1,"btn","btn-primary",3,"click"],["type","button",1,"btn","btn-dark",3,"click"]],template:function(e,o){if(e&1&&h(0,Oi,27,12,"div",0),e&2){let l;E((l=o.data())?0:-1,l)}},dependencies:[V,q,re,Ve,Ee,ye],encapsulation:2})};var dt=class r{static \u0275fac=function(e){return new(e||r)};static \u0275cmp=k({type:r,selectors:[["app-step4-cancel"]],decls:22,vars:0,consts:[[1,"container","py-3"],[1,"row","mb-2"],[1,"col-6"]],template:function(e,o){e&1&&(n(0,"div",0)(1,"div",1)(2,"div",2)(3,"div")(4,"strong"),a(5,"\u8A02\u4F4D\u4EE3\u865F\uFF1A"),t(),a(6," 01976033"),t()(),n(7,"div",2)(8,"div")(9,"strong"),a(10,"\u4ED8\u6B3E\u671F\u9650\uFF1A"),t()()()(),n(11,"div",1)(12,"div",2)(13,"div")(14,"strong"),a(15,"\u8A02\u4F4D\u901A\u8DEF\uFF1A"),t(),a(16," TWE"),t()(),n(17,"div",2)(18,"div")(19,"strong"),a(20,"\u4ED8\u6B3E\u65B9\u5F0F\uFF1A"),t(),a(21," \u5C1A\u672A\u4ED8\u6B3E"),t()()()())},encapsulation:2})};function ji(r,i){if(r&1&&(n(0,"option",32),a(1),t()),r&2){let e=i.$implicit;d("value",e),s(),c(e)}}function Li(r,i){if(r&1&&(n(0,"option",32),a(1),t()),r&2){let e=i.$implicit;d("value",e),s(),c(e)}}var pt=class r{obj={code:[{errorCode:0,errorActionCode:null},{errorCode:1001,errorActionCode:null},{errorCode:3001,errorActionCode:[1]}],data:{paymentType:["\u8ACB\u9078\u64C7","\u73FE\u91D1","\u4FE1\u7528\u5361","\u9280\u806F\u5361"],price:999,lastOtherMarkList:["\u8ACB\u9078\u64C7","\u8B8A\u66F4\u4E59\u6B21","\u4E0D\u5F97\u8B8A\u66F4\u9000\u7968"],lastPaymentOtherPaymentEnable:!1}};transactionAmount=1400;selectedPaymentType="";selectedOtherMark="";rePurchase=!1;tourismCard=!1;changeAmount=0;calculateChange(){this.transactionAmount&&this.obj.data.price&&(this.changeAmount=this.transactionAmount-this.obj.data.price)}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=k({type:r,selectors:[["app-step5"]],decls:61,vars:9,consts:[[1,"py-2"],[1,"border","rounded","p-3","shadow-sm","bg-white","fs-6","m-0","w-100"],[1,"row","mb-2","align-items-center","w-100"],[1,"col-auto","text-warning","fw-bold"],[1,"w-100","d-flex","justify-content-end"],[1,"w-25","d-flex","justify-content-end","align-items-center"],[1,"text-nowrap"],["type","text","disabled","",1,"form-control","form-control-sm","fs-6","ms-1","me-1",3,"value"],[1,"border","rounded","p-3","shadow-sm","bg-white","fs-6","m-0","w-100","mt-2"],[1,"row","mb-3"],[1,"col-md-4","mb-2","d-flex","align-items-center"],[1,"form-div","text-nowrap"],["name","paymentType",1,"form-select","m-2",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"form-check"],["type","checkbox","id","tourismCard","name","tourismCard",1,"form-check-input",3,"ngModelChange","ngModel"],["for","tourismCard",1,"form-check-label"],[1,"form-div","text-nowrap","m-1"],[1,"input-group","align-items-center"],["type","number","name","amount",1,"rounded","fs-6","form-control","form-control-sm","flex-grow-1","m-1",3,"ngModelChange","ngModel"],["name","otherMark",1,"form-select","m-1",3,"ngModelChange","ngModel"],[1,"col-md-2","mb-2","d-flex","align-items-center"],["type","checkbox","id","rePurchase","name","rePurchase",1,"form-check-input","me-1","fs-6","flex-grow-1",3,"ngModelChange","ngModel"],["for","rePurchase",1,"form-check-label"],[1,"row","mb-3","d-flex","align-items-center"],[1,"col-md-4","d-flex","align-items-center"],["type","text","readonly","",1,"rounded","fs-6","form-control","form-control-sm","flex-grow-1","m-1",3,"value"],[1,"col-md-2","d-flex","align-items-center"],["type","button",1,"btn","btn-warning","w-100",3,"click"],[1,"d-flex","align-items-center","gap-2","fs-6","w-100","justify-content-end","mt-2"],["type","button",1,"btn","bg-primary","text-white","px-4"],["type","button",1,"btn","btn-secondary","px-4"],[3,"value"]],template:function(e,o){e&1&&(n(0,"form",0)(1,"div",1)(2,"div",2)(3,"div",3),a(4,"\u8A08\u7B97\u7968\u50F9"),t()(),n(5,"div",4)(6,"div",5)(7,"span",6),a(8,"\u4EA4\u6613\u91D1\u984D\u7E3D\u8A08"),t(),g(9,"input",7),n(10,"div",6),a(11,"\u53F0\u5E63"),t()()()(),n(12,"div",8)(13,"div",2)(14,"div",3),a(15,"\u4ED8\u6B3E"),t()(),n(16,"div",9)(17,"div",10)(18,"div",11),a(19,"\u4ED8\u6B3E\u65B9\u5F0F"),t(),n(20,"select",12),de("ngModelChange",function(m){return ie(o.selectedPaymentType,m)||(o.selectedPaymentType=m),m}),h(21,ji,2,2,"option",13),t()(),n(22,"div",10)(23,"div",14)(24,"input",15),de("ngModelChange",function(m){return ie(o.tourismCard,m)||(o.tourismCard=m),m}),t(),n(25,"label",16),a(26,"\u570B\u6C11\u65C5\u904A\u5361\u9810\u8CFC\u578B\u4EA4\u6613\u8CC7\u6599\u767B\u9304"),t()()()(),n(27,"div",9)(28,"div",10)(29,"div",17),a(30,"\u4ED8\u6B3E\u91D1\u984D"),t(),n(31,"div",18)(32,"input",19),de("ngModelChange",function(m){return ie(o.transactionAmount,m)||(o.transactionAmount=m),m}),t(),n(33,"span"),a(34,"\u53F0\u5E63"),t()()(),n(35,"div",10)(36,"div",17),a(37,"\u5176\u4ED6\u8A3B\u8A18"),t(),n(38,"select",20),de("ngModelChange",function(m){return ie(o.selectedOtherMark,m)||(o.selectedOtherMark=m),m}),h(39,Li,2,2,"option",13),t()(),n(40,"div",21)(41,"div",14)(42,"input",22),de("ngModelChange",function(m){return ie(o.rePurchase,m)||(o.rePurchase=m),m}),t(),n(43,"label",23),a(44,"\u907A\u5931\u518D\u8CFC"),t()()()(),n(45,"div",24)(46,"div",25)(47,"div",11),a(48,"\u627E\u96F6\u91D1\u984D"),t(),n(49,"div",18),g(50,"input",26),n(51,"span"),a(52,"\u53F0\u5E63"),t()()(),n(53,"div",27)(54,"button",28),_("click",function(){return o.calculateChange()}),a(55,"\u8A08\u7B97"),t()()(),n(56,"div",29)(57,"button",30),a(58,"\u4ED8\u6B3E\u6210\u529F"),t(),n(59,"button",31),a(60,"\u5176\u4ED6"),t()()()()),e&2&&(s(9),d("value",o.transactionAmount),s(11),me("ngModel",o.selectedPaymentType),s(),d("ngForOf",o.obj.data.paymentType),s(3),me("ngModel",o.tourismCard),s(8),me("ngModel",o.transactionAmount),s(6),me("ngModel",o.selectedOtherMark),s(),d("ngForOf",o.obj.data.lastOtherMarkList),s(3),me("ngModel",o.rePurchase),s(8),d("value",o.changeAmount))},dependencies:[V,Jt,q,xe,ve,Se,be,ze,Fe,he,oe,ge,Ne,tn],encapsulation:2})};function qi(r,i){if(r&1&&(n(0,"div",1),g(1,"i",2),a(2),t()),r&2){let e=i.$implicit;s(2),P(" ",e,"")}}function Ri(r,i){if(r&1&&(n(0,"div",0),I(1,qi,3,1,"div",1,j),t()),r&2){let e=u();s(),A(e.errors())}}var ut=class r{errors=T([]);messageService=y(le);constructor(){this.messageService.errorComponent=this}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=k({type:r,selectors:[["app-errors"]],decls:1,vars:1,consts:[[1,"d-flex","flex-column","gap-2","pt-2"],[1,"alert","alert-danger","mb-0","p-2"],[1,"fas","fa-exclamation-circle"]],template:function(e,o){e&1&&h(0,Ri,3,0,"div",0),e&2&&E(o.errors().length>0?0:-1)},encapsulation:2})};var ct=class r{errors=T([]);promotions=T([]);step=T(1);step1Query=T(null);step1Data=T(null);step2Data=T(null);step3Data=T(null);step4Data=T(null);mmiService=y(en);constructor(){this.mmiService.breadcrumb.set(["\u7AD9\u52D9\u54E1\u503C\u73ED","\u4E00\u822C\u8A02\u4F4D","\u67E5\u8A62\u65C5\u7A0B\u73ED\u6B21"])}onStep1Confirm(i){this.step1Query.set(i.query),this.step1Data.set(i.data),this.step.set(2),this.mmiService.breadcrumb.set(["\u7AD9\u52D9\u54E1\u503C\u73ED","\u4E00\u822C\u8A02\u4F4D","\u67E5\u8A62\u65C5\u7A0B\u73ED\u6B21","\u9078\u64C7\u8ECA\u6B21"])}onStep2Back(){this.step.set(1),this.mmiService.breadcrumb.set(["\u7AD9\u52D9\u54E1\u503C\u73ED","\u4E00\u822C\u8A02\u4F4D","\u67E5\u8A62\u65C5\u7A0B\u73ED\u6B21"])}onStep2Confirm(i){this.step2Data.set(i),this.step.set(3),this.mmiService.breadcrumb.set(["\u7AD9\u52D9\u54E1\u503C\u73ED","\u4E00\u822C\u8A02\u4F4D","\u67E5\u8A62\u65C5\u7A0B\u73ED\u6B21","\u9078\u64C7\u8ECA\u6B21","\u9078\u64C7\u5EA7\u4F4D/\u586B\u5BEB\u4E58\u5BA2\u8CC7\u6599"])}onStep3Confirm(i){this.step3Data.set(i),this.step.set(4),this.mmiService.breadcrumb.set(["\u7AD9\u52D9\u54E1\u503C\u73ED","\u4E00\u822C\u8A02\u4F4D","\u67E5\u8A62\u65C5\u7A0B\u73ED\u6B21","\u9078\u64C7\u8ECA\u6B21","\u9078\u64C7\u5EA7\u4F4D/\u586B\u5BEB\u4E58\u5BA2\u8CC7\u6599","\u8A02\u4F4D\u5B8C\u6210"])}onStep3Back(){this.step.set(2),this.mmiService.breadcrumb.set(["\u7AD9\u52D9\u54E1\u503C\u73ED","\u4E00\u822C\u8A02\u4F4D","\u67E5\u8A62\u65C5\u7A0B\u73ED\u6B21","\u9078\u64C7\u8ECA\u6B21"])}onStep4Confirm(i){this.step4Data.set(i),this.step.set(5),this.mmiService.breadcrumb.set(["\u7AD9\u52D9\u54E1\u503C\u73ED","\u4E00\u822C\u8A02\u4F4D","\u67E5\u8A62\u65C5\u7A0B\u73ED\u6B21","\u9078\u64C7\u8ECA\u6B21","\u9078\u64C7\u5EA7\u4F4D/\u586B\u5BEB\u4E58\u5BA2\u8CC7\u6599","\u8A02\u4F4D\u5B8C\u6210","\u4ED8\u6B3E"])}onStep4Cancel(){this.step.set(42)}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=k({type:r,selectors:[["app-new"]],decls:7,vars:17,consts:[[3,"confirm","promotions"],[3,"confirm","back","query","data"],[3,"confirm","back","data","promotions"],[3,"confirm","cancel","data"]],template:function(e,o){e&1&&(g(0,"app-errors"),n(1,"app-step1",0),_("confirm",function(m){return o.onStep1Confirm(m)})("promotions",function(m){return o.promotions.set(m)}),t(),n(2,"app-step2",1),_("confirm",function(m){return o.onStep2Confirm(m)})("back",function(){return o.onStep2Back()}),t(),n(3,"app-step3",2),_("confirm",function(m){return o.onStep3Confirm(m)})("back",function(){return o.onStep3Back()}),t(),n(4,"app-step4",3),_("confirm",function(m){return o.onStep4Confirm(m)})("cancel",function(){return o.onStep4Cancel()}),t(),g(5,"app-step4-cancel")(6,"app-step5")),e&2&&(s(),W("d-none",o.step()!==1),s(),W("d-none",o.step()!==2),d("query",o.step1Query())("data",o.step1Data()),s(),W("d-none",o.step()!==3),d("data",o.step2Data())("promotions",o.promotions()),s(),W("d-none",o.step()!==4),d("data",o.step3Data()),s(),W("d-none",o.step()!==42),s(),W("d-none",o.step()!==5))},dependencies:[V,q,it,rt,st,mt,dt,pt,ut],styles:["[_nghost-%COMP%]{display:block;height:100%}"]})};var Yi=[{path:"",component:tt,children:[{path:"new",component:ct},{path:"**",redirectTo:"new"}]}],gn=class r{static \u0275fac=function(e){return new(e||r)};static \u0275mod=Yt({type:r});static \u0275inj=qt({imports:[V,Qe.forChild(Yi)]})};export{gn as TicketsModule};
